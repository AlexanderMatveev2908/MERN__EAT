import{r as m,j as e,u as Z,a as D,N as U,C as ve,P as Ct,H as Rt,B as It,F as At,b as Dt,I as Ft,c as C,d as M,e as E,f as Tt,g as qe,G as kt,T as ze,h as hs,M as Lt,i as V,k as Ge,l as ys,m as ws,n as js,o as Mt,p as Ut,q as $t,s as bs,t as _s,v as Vt,w as Ot,K as vs,S as Ns,U as Ss,L as Ps,x as Bt,y as qt,z as ds,A as zt,D as Es,E as Qe,J as Cs,O as Rs,Q as Is,R as As,V as Gt,W as Ds,X as Qt,Y as Ht,Z as He,_ as Yt,$ as Ye,a0 as re,a1 as Zt,a2 as Wt,a3 as Ze,a4 as Kt,a5 as Xt,a6 as Ne,a7 as ae,a8 as Jt,a9 as ea,aa as Fs,ab as sa,ac as Ts,ad as ue,ae as ta,af as aa,ag as na,ah as ra,ai as la,aj as ia,ak as oa,al as ca,am as da,an as ua,ao as Se,ap as ks,aq as We,ar as ma,as as pa,at as xa,au as ga,av as fa,aw as me,ax as Ls,ay as ha,az as ya,aA as wa,aB as ja,aC as ba,aD as _a,aE as N,aF as va,aG as Na,aH as Sa}from"./vendor-react-4In-kT_s.js";import{a as Pa,v as Ea,b as Ca}from"./vendor-BimTZaDL.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const l of r)if(l.type==="childList")for(const i of l.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function a(r){const l={};return r.integrity&&(l.integrity=r.integrity),r.referrerPolicy&&(l.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?l.credentials="include":r.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function n(r){if(r.ep)return;r.ep=!0;const l=a(r);fetch(r.href,l)}})();const F=()=>{m.useEffect(()=>{setTimeout(()=>{window.scrollTo({top:0,behavior:"smooth"})},200)},[])},Ra=()=>(F(),e.jsx("div",{className:"w-full flex flex-col items-center gap-y-5",children:e.jsxs("div",{className:"w-full flex flex-col items-start gap-y-3",children:[e.jsx("span",{className:"txt__04 text-[whitesmoke]",children:"Order Comfortably From Home"}),e.jsx("span",{className:"txt__04 text-[whitesmoke]",children:"Or Manage Your Business From Anywhere"})]})})),le=(s,t)=>s&&t.test(s),ce=(s,t)=>s.includes(t??""),Ia=()=>{var i;F();const[s]=Z(),t=D(),a=s.get("type"),n=(i=t==null?void 0:t.state)==null?void 0:i.from;return{canStay:ce(["verify-account","recover-pwd","sentEmailUnsubscribe","change-email","change-pwd"],a??"")&&ce(["/auth/register","/auth/login","/newsletter/notice-unsubscribe-with-retry","/user/manage-account"],n),txt:a==="verify-account"?"to verify your account":a==="recover-pwd"?"with a link to recover your password":a==="change-email"?"to verify your new email":"with a link to unsubscribe from our newsletter"}},Aa=()=>{const{canStay:s,txt:t}=Ia();return s?e.jsxs("div",{className:"w-full flex flex-col items-center gap-y-14",children:[e.jsx("div",{className:"w-full flex justify-center",children:e.jsx("span",{className:"txt__04 leading-10 lg:leading-16",children:`We've sent you an email ${t}! If you don't see it, check your
          spam folder, it might be partying there`})}),e.jsx("div",{className:"w-full flex justify-center items-center",children:e.jsx(ve,{className:"w-[200px] sm:w-[300px] h-[200px] sm:h-[300px] md:w-[400px] md:h-[400px] text-green-600"})})]}):e.jsx(U,{to:"/",replace:!0})},Da=()=>e.jsx("div",{className:"w-full spinner_btn flex justify-center gap-4",children:Array.from({length:4}).map((s,t)=>e.jsx("span",{className:"spinner_tbn__el",style:{"--i":t+1}},t))}),Pe=()=>e.jsx("div",{className:"w-full flex justify-self-center",children:e.jsx(Da,{})}),G=({isDisabled:s,label:t,type:a="button",handleClick:n,styleTxt:r,isPending:l})=>l?e.jsx(Pe,{}):e.jsxs("button",{onClick:n,type:a,disabled:s,className:"btn_container",children:[e.jsxs("div",{className:"btn_container__content",children:[e.jsx("div",{className:"content__btn",children:e.jsx("span",{className:`relative z-40 ${r??"btn__txt"}`,children:t??"BUTTON"})}),e.jsx("span",{className:"btn__ref_1"}),e.jsx("span",{className:"btn__ref_2"})]}),e.jsx("span",{className:"btn_container__shadow"}),e.jsx(Ct,{className:"btn_container__svg_1"}),e.jsx(Rt,{className:"btn_container__svg_2"}),e.jsx(It,{className:"btn_container__svg_3"}),e.jsx(At,{className:"btn_container__svg_4"}),e.jsx(Dt,{className:"btn_container__svg_5"}),e.jsx(Ft,{className:"btn_container__svg_6"})]}),fe=({register:s,errors:t,field:a,custom:n})=>{var r,l;return e.jsxs("label",{className:"grid grid-cols-1 gap-y-3",children:[e.jsx("span",{className:"txt__02",children:a.label}),e.jsxs("div",{className:"w-full relative",children:[e.jsx("input",{type:a.type,className:"input__auth_field ",placeholder:`Your ${a.label}...`,...s(a.field,{required:`${a.label} is required`,validate:i=>!i||!a.reg.test(i)?a.msg:n?n==null?void 0:n(i):!0})}),e.jsx(a.svg,{className:"svg__auth_field"})]}),((r=t==null?void 0:t[a.field])==null?void 0:r.message)&&e.jsx("span",{className:"txt__00 text-red-600",children:(l=t==null?void 0:t[a.field])==null?void 0:l.message})]})},Ms=m.createContext(null),Ee=()=>{const s=m.useContext(Ms);if(!s)throw new Error("useGlobal must be used within a GlobalProvider");return s},R=()=>Ee().toastState,$=()=>Ee().userState,pe=()=>Ee().popupState,he=()=>Ee().formsState,I=()=>{const{showToastMsg:s}=R(),t=C(),{logoutUser:a}=$();return{handleErrAPI:m.useCallback(({err:r,push:l=!1,toast:i=!0})=>{var u,g,p,f,y;console.log(r);const c=((g=(u=r==null?void 0:r.response)==null?void 0:u.data)==null?void 0:g.msg)||r.message,o=((f=(p=r==null?void 0:r.response)==null?void 0:p.config)==null?void 0:f.url)||"",d=(y=r==null?void 0:r.response)==null?void 0:y.status;o==="/auth/refresh"?(a(),t("/",{replace:!0}),s("SESSION EXPIRED","ERROR")):[401,403,429].includes(d??400)?(["USER DOES NOT EXIST","USER NOT VERIFIED"].includes(c)&&a(),t("/",{replace:!0}),s(c,"ERROR")):(l&&t("/",{replace:!0}),i&&s(c,"ERROR"))},[t,s,a])}},b=Pa.create({baseURL:"/api/v1",withCredentials:!0});b.interceptors.request.use(s=>{const t=sessionStorage.getItem("accessToken");return t&&(s.headers.Authorization=`Bearer ${t}`),s},s=>Promise.reject(s));b.interceptors.response.use(s=>s,async s=>{var n,r,l;const t=s.config,a=t.url==="/auth/refresh";if(((n=s==null?void 0:s.response)==null?void 0:n.status)===401&&["ACCESS TOKEN EXPIRED","ACCESS TOKEN INVALID","ACCESS TOKEN NOT PROVIDED"].includes((l=(r=s==null?void 0:s.response)==null?void 0:r.data)==null?void 0:l.msg)&&!a&&!t.retry)try{t.retry=!0;const{data:i}=await b.get("/auth/refresh");return sessionStorage.setItem("accessToken",i.accessToken),t.headers.Authorization=`Bearer ${i.accessToken}`,b(t)}catch(i){return sessionStorage.removeItem("accessToken"),Promise.reject(i)}return Promise.reject(s)});const Fa=async()=>{const{data:s}=await b.get("/user/info-basic");return s},Ta=async()=>{const{data:s}=await b.get("/user/profile-details");return s},ka=async s=>{const{data:t}=await b.patch("/user/profile-details",s);return t},La=async s=>{const{data:t}=await b.post("/user/manage-account",{password:s});return t},Ma=async s=>{const{data:t}=await b.patch("/user/change-email",{...s});return t},Ua=async s=>{const{data:t}=await b.post("/user/verify-new-email",s);return t},$a=async s=>{const{data:t}=await b.patch("/user/change-old-pwd",s);return t},Va=async s=>{const{data:t}=await b.delete("/user/delete-account",{data:{manageAccountToken:s}});return t},Oa=async({type:s})=>{const{data:t}=await b.patch("/newsletter/toggle-logged",{type:s});return t},Ba=async s=>{const{data:t}=await b.post("/newsletter/subscribe-non-logged",{email:s});return t},qa=async s=>{const{data:t}=await b.patch("/newsletter/unsubscribe-via-link-logged",s);return t},za=async s=>{const{data:t}=await b.delete("/newsletter/unsubscribe-via-link-non-logged",{data:s});return t},Ga=async({email:s})=>{const{data:t}=await b.post("/newsletter/send-email-unsubscribe",{email:s});return t},Qa=async s=>{const{data:t}=await b.post("/my-restaurants",s);return t},Ha=async s=>{const{data:t}=await b.get(`/my-restaurants?${s}`);return t},Ya=async s=>{const{data:t}=await b.get(`/my-restaurants/info-restaurant/${s}`);return t},Za=async({id:s,formData:t})=>{const{data:a}=await b.patch(`/my-restaurants/${s}`,t);return a},Wa=async s=>{const{data:t}=await b.delete(`/my-restaurants/${s}`);return t},Ka=async s=>{const{data:t}=await b.get(`/my-restaurants/${s}`);return t},Xa=async s=>{const{data:t}=await b.post("/auth/register",{...s});return t},Ja=async({email:s,password:t})=>{const{data:a}=await b.post("/auth/login",{email:s,password:t});return a},en=async()=>{const{data:s}=await b.post("/auth/logout");return s},sn=async({email:s,type:t})=>{const{data:a}=await b.post(`/auth/send-email?type=${t}`,{email:s});return a},tn=async({...s})=>{const{data:t}=await b.post("/auth/verify-account",s);return t},an=async({...s})=>{const{data:t}=await b.post("/auth/verify-recover-pwd",s);return t},nn=async({...s})=>{const{data:t}=await b.patch("/auth/recover-pwd",s);return t},rn=async()=>{const{data:s}=await b.get("/auth/refresh");return s},ln=()=>{const{setUserLogged:s}=$(),{showToastMsg:t}=R(),{handleErrAPI:a}=I();F();const n=C(),{register:r,handleSubmit:l,reset:i,formState:{errors:c},setFocus:o}=M({mode:"onSubmit"});m.useEffect(()=>{o("email")},[o]);const{mutate:d,isPending:u}=E({mutationFn:p=>Ja(p),onSuccess:p=>{i(),s(p.accessToken),t("User logged in successfully","SUCCESS"),n("/")},onError:p=>{var f,y,x;[401,403].includes(((f=p==null?void 0:p.response)==null?void 0:f.status)??400)?t(((x=(y=p==null?void 0:p.response)==null?void 0:y.data)==null?void 0:x.msg)??"","ERROR"):a({err:p})}}),g=l(p=>{d({...p})});return{register:r,errors:c,handleLoginUser:g,isPending:u}},be=/^[A-Z][a-zA-ZÀ-ÿ`'-_\d\s]*$/,Us=/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[\W_])[A-Za-zÀ-ÿ\d\W_]{8,}$/,Ke=/^(?![.-])(?!.*[.-]$)(?!.*\.\.)(?!.*@.*@)[A-Za-zÀ-ÿ0-9._%+-]+@[A-Za-zÀ-ÿ0-9]+\.[A-Za-z]{2,}$/,W=/^[a-f0-9]{24}$/,Ce=/^[a-f0-9]{128}$/,on=/^[A-Za-zÀ-ÿ\d\s_]{2,50}$/,cn=/^[A-Za-zÀ-ÿ\d\s-_]{2,50}$/,dn=/^[A-Za-zÀ-ÿ\d\s-_]{2,50}$/,un=/^[A-Za-zÀ-ÿ0-9\s,.#-]{5,100}$/,mn=/^\d{5}(-\d{4})?$/,$s=/^\+?\d{1,4}[\s-]?\(?\d{2,3}\)?[\s-]?\d{3,4}[\s-]?\d{3,4}$/,pn=/^[A-Za-zÀ-ÿ0-9\s_\-!@#$%^&*()+=.,'"_]{2,50}$/,xn=/^(https?:\/\/)?(www\.)?[A-Za-z0-9-]+(\.[A-Za-z]{2,})(\/[A-Za-z0-9-/]*)?(\?[A-Za-z0-9=&]*)?(#[A-Za-z0-9-_]*)?$/,Te=/^([01]?[0-9]|2[0-3]):([0-5]?[0-9])$/,de=/^\d+(\.\d{1,2})?$/,Vs=/^\d+$/,Os=/^[A-Za-zÀ-ÿ0-9\s,&!`'-_]*$/,us=/^\d*$/,Bs=/^\d+$/,gn=/^[A-Za-zÀ-ÿ0-9\s_\-!@#$%^&*()+=.,'"_]{2,30}$/,qs=(s,t)=>{var a,n;return!(!s[1]||["search","searchVals"].includes(s[0])&&(!((a=t.searchVals)!=null&&a.length)||!t.search||!Os.test(t.search)||["id","restaurantId"].includes((n=t.searchVals)==null?void 0:n[0])&&!W.test(t.search)))},fn=s=>{var a;const t=new URLSearchParams;for(const n of Object.entries(s??{}))qs(n,s)&&(Array.isArray(n[1])?(a=n[1])!=null&&a.length&&t.append(n[0],n[1].join(",")):t.append(n[0],n[1]));return t},ms=s=>{var a;const t=new URLSearchParams;if(!s)return t;for(const n of Object.entries(s??{}))if(n[1]&&qs(n,s))if(Array.isArray(n[1]))(a=n[1])!=null&&a.length&&t.append(n[0],n[1].join(", "));else{if([s.minPrice,s.maxPrice].every(r=>r!=="")&&(n[0]==="minPrice"&&+n[1]>+s.maxPrice||n[0]==="maxPrice"&&+n[1]<s.minPrice)||[s.minQuantity,s.maxQuantity].every(r=>r!=="")&&(n[0]==="minQuantity"&&+n[1]>+s.maxQuantity||n[0]==="maxQuantity"&&+n[1]<+s.minQuantity)||["minPrice","maxPrice"].includes(n[0])&&!de.test(n[1])||["minQuantity","maxQuantity"].includes(n[0])&&!Bs.test(n[1]))continue;t.append(n[0],n[1])}return t},hn=s=>{var t,a;return((t=s.firstName.slice(0,1))==null?void 0:t.toUpperCase())+((a=s.lastName.slice(0,1))==null?void 0:a.toUpperCase())},ke=s=>{if(!Vs.test(s+""))return"00:00";const t=Math.floor(s/60),a=s%60;return`${(t+"").padStart(2,"0")}:${(a+"").padStart(2,"0")}`},ge=s=>{if(!s||!Te.test(s))return 0;const[t,a]=s.split(":").map(n=>+n);return t*60+a},De=(s,t)=>(ge(s)-ge(t))/60,zs=s=>{const t=new FormData,{images:a,categories:n,...r}=s;[...a].every(i=>i instanceof File)?[...a].forEach(i=>t.append("restaurantImages",i)):t.append("restaurantImages",JSON.stringify(a)),n.forEach(i=>t.append("categories",i));for(const i in r)r[i]&&(["openTime","closeTime"].includes(i)?t.append(i,`${ge(r[i])+""}`):t.append(i,r[i]));return t},yn=s=>{const t=new FormData;let a=0;for(;a<s.items.length;){const{images:n,...r}=s.items[a],l=[...n].every(i=>i instanceof File);n!=null&&n.length&&l?[...n].forEach(i=>{t.append(`images_${a}`,i)}):t.append(`images_${a}`,JSON.stringify(n));for(const i in r)t.append(`dishes[${a}][${i}]`,r[i]);a++}return t},wn=s=>{const t=new FormData,{images:a,...n}=s.items[0],r=[...a].every(l=>l instanceof File);a!=null&&a.length&&r?[...a].forEach(l=>{t.append("images",l)}):t.append("images",JSON.stringify(a));for(const l in n)t.append(l,n[l]);return t.append("restaurant",s.restaurant),t},Xe=({price:s,showStr:t=!1})=>{const a=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(s??0);return!s&&t?"Free":a},Gs=({location:s,el:t,type:a})=>t!=null&&t.from&&a?a===t.path.split("=")[1]?"active":"":s.pathname===t.path?"active":"",ps={full:Tt,empty:qe},jn=s=>{const t=[];for(let a=0;a<5;a++)s>=a+1?t.push(ps.full):t.push(ps.empty);return t},h=()=>Ea(),bn=s=>[{label:"Update",path:`/my-restaurants/update/${s}`,icon:kt},{label:"Delete",path:"",icon:ze},{label:"Add dish",path:"/my-dishes/add-dish",icon:hs},{label:"My dishes",path:"/my-dishes",icon:Lt},{label:"My orders",path:"/my-orders",icon:V},{label:"My reviews",path:"/my-reviews",icon:Ge}].map(t=>({...t,id:h()})),_n=(...s)=>[{id:h(),label:"Location",vals:s[0],icon:ys},{id:h(),label:"Contact",vals:s[1],icon:ws},{id:h(),label:"Categories",vals:s[2],icon:js}],vn={id:h(),label:"Open Hours",icon:$t},Nn=(...s)=>[{id:h(),icon:Mt,val:ke(s[0])},{id:h(),icon:Ut,val:ke(s[1])}],Sn={id:h(),label:"Delivery",icon:bs},Pn=(...s)=>[{id:h(),label:"Delivery time",val:s[0]},{id:h(),label:"Price",val:s[1]},{id:h(),label:"Free meal",val:s[2]}],En=(...s)=>["Pending","Processing","Shipped","Delivered","Cancelled"].map((t,a)=>({id:h(),label:t,val:s[a].count})),Cn={id:h(),icon:_s,label:"Orders"},Rn={id:h(),label:"Reviews",icon:Vt},In=(...s)=>Array.from({length:5}).map((t,a)=>({id:h(),val:s[a].count,stars:jn(a+1)})),An={id:h(),label:"Dishes",icon:Ot},Dn=(...s)=>[{label:"Avg price",field:Xe({price:s[0]})},{label:"Avg quantity",field:s[1]},{label:"Dishes count",field:s[2]}],Fn=(...s)=>[{label:"Avg rating",field:s[0]},{label:"Reviews count",field:s[1]}].map(t=>({...t,id:h()})),Tn=[{id:h(),label:"Forgot password",svg:vs,type:"login"},{id:h(),label:"Verify account",svg:Ns,type:"register"}],kn=[{id:h(),label:"Create account",svg:Ss,type:"login"},{id:h(),label:"Login in your account",svg:Ps,type:"register"}],Je=[{id:h(),field:"firstName",label:"First Name",reg:be,msg:"First Name should start with a capital letter and can only contains letters and apostrophe "},{id:h(),field:"lastName",label:"Last Name",reg:be,msg:"Last Name should start with a capital letter and can only contains letters and apostrophe"}],Re=[{id:h(),field:"country",label:"Country",reg:on,msg:"Country can only contains letters, and must be at least 2 chars"},{id:h(),field:"state",label:"State",reg:cn,msg:"State can only contains can only contains letters and hyphens if needed, and must be at least 2 chars "},{id:h(),field:"city",label:"City",reg:dn,msg:"City can only contains letters and hyphens if needed, and must be at least 2 chars"}],Ie=[{id:h(),field:"street",label:"Street",reg:un,msg:"Street can only contains letters, numbers, and spaces, and must be at least 5 chars"},{id:h(),field:"zipCode",label:"Zip Code",reg:mn,msg:"Zip Code can only contains numbers, at least 5 up to 10 digits"},{id:h(),field:"phone",label:"Phone",reg:$s,msg:"Phone can only contains numbers,and including country prefix up to 15 digits "}],Ln=[...Je,...Re,...Ie],Mn=[[...Je],[...Re],[...Ie]],es=3,Un=/(?=.*[A-Z])/,$n=/[a-z]+/,Vn=/(?=.*\d)/,On=/(?=.*[\W_])/,Bn=[{id:h(),msg:"Uppercase letters",reg:Un,label:"ABC..."},{id:h(),msg:"Lowercase letters",reg:$n,label:"abc..."},{id:h(),msg:"Numbers",reg:Vn,label:"123..."},{id:h(),msg:"Symbols",reg:On,label:"!@#$..."}],qn="/assets/hero-C0USUQ76.avif",zn="/assets/hero_2-My4mLI9C.avif",Gn="/assets/hero_5-DfOWyyJE.avif",Qn="/assets/hero_6-B4eY8YHC.avif",Hn=[{id:h(),img:qn},{id:h(),img:zn},{id:h(),img:Gn},{id:h(),img:Qn}],Yn=[{id:h(),label:"About",path:"/"},{id:h(),label:"Privacy Policy",path:"/"},{id:h(),label:"Terms & Conditions",path:"/"},{id:h(),label:"Contact",path:"/"}],Zn=[{id:h(),label:"Source Code",svg:Bt,url:"https://github.com/AlexanderMatveev2908/FOOD_APP"},{id:h(),label:"Hotels App",svg:qt,url:"https://mern-booking-app-0w8v.onrender.com/"}],ye={id:h(),field:"email",label:"Email",reg:Ke,msg:"Email must follow this pattern /^(?![.-])(?!.*[.-]$)(?!.*\\.\\.)(?!.*@.*@)[A-Za-z0-9._%+-]+@[A-Za-z0-9]+\\.[A-Za-z]{2,}$/ 🧐",svg:zt,type:"email"},Wn={...ye,label:"New Email",field:"newEmail"},Kn=[{id:h(),field:"firstName",label:"First Name",reg:be,msg:"A First Name must start with uppercase letter, and can include only letters and apostrophe.",svg:ds,type:"text"},{id:h(),field:"lastName",label:"Last Name",reg:be,msg:"A Last Name must start with uppercase letter, and can include only letters and apostrophe",svg:ds,type:"text"}],ss={id:h(),field:"password",label:"Password",place:"Your password",msg:"Invalid password",reg:/.*/},ts={...ss,reg:Us,msg:"Password must follow this pattern /^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[\\W_])[A-Za-z\\d\\W_]{8,}$/ 🧐"},Xn={...ts,label:"New Password",place:"Your new password",field:"newPassword"},as={id:h(),field:"confirmPassword",label:"Confirm Password",place:"Confirm your password",msg:"",reg:/.*/},Jn={id:h(),label:"Name",field:"name",required:!0,reg:pn,msg:"Restaurant name must be between 2 and 50 characters"},Qs=[...Re.map(s=>({...s,required:!0}))],Hs=Ie.filter(s=>s.field!=="phone").map(s=>({...s,required:!0})),er=[[...Qs],[...Hs]],Le=2,sr=[{id:h(),field:"email",label:"Email (if different from personal)",place:"Your email address...",required:!1,reg:Ke,msg:"Email must follow this pattern /^(?![.-])(?!.*[.-]$)(?!.*\\.\\.)(?!.*@.*@)[A-Za-z0-9._%+-]+@[A-Za-z0-9]+\\.[A-Za-z]{2,}$/ 🧐",type:"email"},{id:h(),field:"phone",label:"Phone (if different from personal)",place:"Your phone number...",required:!1,reg:$s,msg:"Phone can only contains numbers,and including country prefix up to 15 digits"},{id:h(),field:"website",label:"Website (if you have one)",place:"Your website url...",required:!1,reg:xn,msg:"A URL can have optionally the protocol, subdomain, must have main domain and eventually path query or fragment",type:"url"}],tr=[{id:h(),field:"openTime",label:"Open time",place:"Open time (8:00 e.g)",reg:Te,required:!0,msg:"Follow format HH:MM"},{id:h(),field:"closeTime",label:"Close time",place:"Close time (21:00 e.g)",reg:Te,required:!0,msg:"Follow the format HH:MM"}],ns=["italian","chinese","japanese","mexican","indian","french","mediterranean","fast-food","vegetarian","vegan","seafood","steakhouse"],H=ns.map(s=>({field:s,id:h(),label:s==="fast-food"?"Fast-Food":s.charAt(0).toUpperCase()+s.slice(1)})),_e=Math.ceil(H.length/6),Ys=[];for(let s=0;s<(H==null?void 0:H.length);s++)s%6===0&&Ys.push([...H.slice(s,s+6)]);const ar=[{id:h(),type:"number",field:"estTimeDelivery",label:"Delivery time",msg:"Invalid format, write delivery time in minutes (e.g 20)",required:!0,place:"Delivery time...",reg:Vs},{id:h(),type:"number",field:"price",label:"Charge for delivery",msg:"Delivery charge must be a positive decimal number with at most 2 decimal places.",required:!1,place:"Leave empty if no charge",reg:de},{id:h(),type:"number",field:"freeDeliveryPrice",label:"Amount free delivery",msg:"The value must be a positive decimal number with at most 2 decimal places.",required:!1,place:"Leave empty if no amount",reg:de}],nr=["name","country","state","city","id"],rr=nr.map(s=>({field:s,id:h(),label:s[0].toUpperCase()+s.slice(1)})),lr=ns.map(s=>({field:s,id:h(),label:s==="fast-food"?"Fast-Food":s[0].toUpperCase()+s.slice(1)})),ir=["0-19","20-39","40-59","60-79","80-100"],or=ir.map((s,t,a)=>({field:s,id:h(),label:`$${s}${t===a.length-1?"+":""}`})),cr=["0-1","1.1-2","2.1-3","3.1-4","4.1-5"],dr=cr.map(s=>({field:s,id:h(),label:`⭐ ${s}`})),ur=["pending","processing","shipped","delivered","cancelled"].map(s=>({field:s,id:h(),label:s[0].toUpperCase()+s.slice(1)})),mr=["0-9","10-19","20-29","30-39","40-49","50-59","60-69","70-79","80-89","90-100"].map((s,t,a)=>({id:h(),label:t===a.length-1?"100+":s,field:s})),Zs=[{field:"ordersStatus",label:"Orders status",subFields:ur,icon:V},{field:"avgRatingRange",label:"Avg rating",subFields:dr,icon:qe},{field:"categories",label:"Category",subFields:lr,icon:Es},{field:"avgPriceRange",label:"Avg price dish",subFields:or,icon:Qe},{field:"avgQuantityRange",label:"Avg quantity dish",subFields:mr,icon:V}].map(s=>({...s,id:h()})),Ws=[{field:"createdAtSort",label:"Created at",icon:Cs},{field:"updatedAtSort",label:"Updated at",icon:Rs},{field:"avgRatingSort",label:"Avg rating",icon:qe},{field:"pendingOrdersSort",label:"Pending orders",icon:V},{field:"processingOrdersSort",label:"Processing orders",icon:V},{field:"shippedOrdersSort",label:"Shipped orders",icon:V},{field:"deliveredOrdersSort",label:"Delivered orders",icon:V},{field:"cancelledOrdersSort",label:"Cancelled orders",icon:V},{field:"ordersCountSort",label:"No. of orders",icon:_s},{field:"reviewCountsSort",label:"No. of reviews",icon:Ge},{field:"avgPriceSort",label:"Avg price dish",icon:Qe},{field:"avgQuantitySort",label:"Avg quantity dish",icon:V},{field:"dishesCountSort",label:"No. of dishes",icon:js}],pr=[{field:"asc",icon:Is},{field:"desc",icon:As}],xr=Ws.map(s=>({...s,id:h(),subFields:[...pr.map(t=>({...t,id:h()}))]}));[...Zs.map(s=>s.field),...Ws.map(s=>s.field)];const gr={search:"",searchVals:["name"],categories:[],ordersStatus:[],avgPriceRange:[],avgQuantityRange:[],avgRatingRange:[],avgRatingSort:[],reviewsCountSort:[],avgPriceSort:[],dishesCountSort:[],avgQuantitySort:[],ordersCountSort:[],createdAtSort:[],updatedAtSort:[],pendingOrdersSort:[],processingOrdersSort:[],shippedOrdersSort:[],deliveredOrdersSort:[],cancelledOrdersSort:[],page:"1"},fr=[{id:h(),path:"/",label:"Home",svg:Gt}],Ks=[{id:h(),path:"/user/profile",label:"Profile",svg:Ds},{id:h(),path:"/user/manage-account",label:"Manage Account",svg:Qt}],hr=[{id:h(),path:"/my-restaurants",label:"My restaurants",svg:Ht},{id:h(),path:"/my-restaurants/add-restaurant",label:"Create restaurant",svg:He},{id:h(),path:"/my-dishes",label:"My dishes",svg:Yt},{id:h(),label:"Add dish",path:"/my-dishes/add-dish",svg:hs},{id:h(),path:"/manage-orders",label:"Manage orders",svg:V},{id:h(),path:"/users-reviews",label:"Users reviews",svg:Ge}],xs={id:h(),label:"Admin menu",icon:Ye},yr=Ks.slice(0,2),Xs=[{id:h(),path:"/auth/login",label:"Login",svg:Ps},{id:h(),path:"/auth/send-email?type=recover-pwd",label:"Recover Password",from:"/auth/login",svg:vs},{id:h(),path:"/auth/register",label:"Register",svg:Ss},{id:h(),path:"/auth/send-email?type=verify-account",label:"Verify Account",from:"/auth/register",svg:Ns}],Js=({type:s})=>{const t=C(),a=D();return e.jsxs("div",{className:"w-full grid grid-cols-1 gap-y-5 sm:grid-cols-2",children:[e.jsx("button",{type:"button",onClick:()=>t(`/auth/send-email?type=${s==="login"?"recover-pwd":"verify-account"}`,{state:{from:a.pathname}}),className:"w-full flex items-center gap-3 group el__after_below cursor-pointer",children:Tn.map(n=>n.type===s&&e.jsxs(m.Fragment,{children:[e.jsx(n.svg,{className:"svg__switch_form"})," ",e.jsx("span",{className:"el__flow group-hover:text-orange-500 txt__00",children:n.label})]},n.id))}),e.jsx(re,{to:s==="login"?"/auth/register":"/auth/login",className:"w-full flex items-center gap-3 group el__after_below sm:justify-self-end",children:kn.map(n=>n.type===s&&e.jsxs(m.Fragment,{children:[e.jsx(n.svg,{className:"svg__switch_form"}),e.jsx("span",{className:"el__flow group-hover:text-orange-500 txt__00",children:n.label})]},n.id))})]})},se=({register:s,errors:t,isVisible:a,handleChangeVisibility:n,field:r,custom:l})=>{var c,o;const i={required:"Password is required",pattern:{value:r.reg,message:r.msg},validate:d=>l?l(d):!0};return e.jsxs("label",{className:"grid grid-cols-1 gap-y-3 relative",children:[e.jsx("span",{className:"txt__02",children:r.label}),e.jsxs("div",{className:"w-full relative",children:[e.jsx("input",{type:a?"text":"password",className:"input__auth_field ",placeholder:r.place,...s(r.field,i)}),e.jsx("span",{onClick:()=>n(),className:"w-fit flex justify-center items-center",children:a?e.jsx(Zt,{className:"svg__auth_field"}):e.jsx(Wt,{className:"svg__auth_field"})})]}),((c=t==null?void 0:t[r.field])==null?void 0:c.message)&&e.jsx("span",{className:"txt__00 text-red-600",children:(o=t==null?void 0:t[r.field])==null?void 0:o.message})]})},wr=()=>{const{register:s,errors:t,isPending:a,handleLoginUser:n}=ln(),[r,l]=m.useState(!1);return e.jsxs("div",{className:"w-full grid grid-cols-1 gap-y-10 items-center",children:[e.jsx("div",{className:"w-full flex justify-center",children:e.jsx("span",{className:"txt__04",children:"Login"})}),e.jsx("div",{className:"w-full justify-self-center max-w-[600px] grid grid-cols-1 border-2 border-orange-500 rounded-xl p-10",children:e.jsx("div",{className:"w-full grid grid-cols-1",children:e.jsxs("form",{onSubmit:n,className:"grid grid-cols-1 w-full gap-y-8",children:[e.jsx(fe,{register:s,errors:t,field:ye}),e.jsx(se,{register:s,errors:t,isVisible:r,handleChangeVisibility:()=>l(!r),field:ss}),e.jsx("div",{className:"w-full mt-2 max-w-[225px] md:max-w-[250px] justify-self-center flex justify-center",children:e.jsx(G,{styleTxt:"txt__02",label:"Login",type:"submit",isPending:a})}),e.jsx("div",{className:"w-full",children:e.jsx(Js,{type:"login"})})]})})})]})},jr=({register:s,errors:t,valTerms:a})=>{var c,o;const n=!!((c=t==null?void 0:t.acceptedTerms)!=null&&c.message),r=m.useRef(null),[l,i]=m.useState(!1);return m.useEffect(()=>{const d=u=>{var g;if(!(!r.current||a===void 0)&&(g=r.current)!=null&&g.contains(u.target)){const p=document.getElementById("squareCheck");p==null||p.classList.remove("register__checkbox"),requestAnimationFrame(()=>{p==null||p.classList.add("register__checkbox")})}};return document.addEventListener("click",d),()=>{document.removeEventListener("click",d)}},[a,l]),e.jsxs("div",{className:"w-full grid grid-cols-1 gap-2 ",children:[e.jsxs("label",{ref:r,className:"w-full flex gap-10 max-w-fit justify-start relative py-2 cursor-pointer items-center",children:[e.jsx("input",{type:"checkbox",className:"opacity-0",...s("acceptedTerms",{required:"You must accept terms and conditions"})}),e.jsx("span",{id:"squareCheck",onClick:()=>i(!0),className:`absolute top-1 left-0 border-[3px] rounded-xl w-[30px] sm:w-[35px] h-[30px] sm:h-[35px] cursor-pointer ${a?"border-green-600":a===void 0||!l?"border-white":"border-red-600"}`}),e.jsx("span",{className:`absolute delay-75 -top-2 sm:-top-3 left-4 w-3 sm:w-4 h-8 sm:h-10 border-r-4 border-b-4 rotate-45 border-green-600 el__flow cursor-pointer ${a?"scale-100":"scale-0"}`}),e.jsx("span",{className:`txt__01 el__flow ${a?"hover:text-green-600":a===void 0?"border-white":"hover:text-red-600"}`,children:"I Accept Terms And Conditions"})]}),n&&e.jsx("span",{className:"txt__00 text-red-600",children:(o=t==null?void 0:t.acceptedTerms)==null?void 0:o.message})]})},rs=({isConfirmPwdVisible:s,setIsConfirmPwdVisible:t,isPwdVisible:a,setIsPwdVisible:n})=>({handleChangePwdVisibility:()=>{s?(t(!1),n(!0)):n(!a)},handleChangeConfirmPwdVisibility:()=>{a?(n(!1),t(!0)):t(!s)}}),br=()=>{const[s,t]=m.useState(!1),[a,n]=m.useState(!1);F();const r=C(),l=D(),{handleChangePwdVisibility:i,handleChangeConfirmPwdVisibility:c}=rs({isPwdVisible:s,setIsPwdVisible:t,isConfirmPwdVisible:a,setIsConfirmPwdVisible:n}),{showToastMsg:o}=R(),{register:d,handleSubmit:u,reset:g,watch:p,trigger:f,formState:{errors:y},setFocus:x}=M({mode:"onChange"});m.useEffect(()=>{x("firstName")},[x]);const w=p("password");m.useEffect(()=>{w&&f("confirmPassword")},[w,f]);const{mutate:j,isPending:_}=E({mutationFn:v=>Xa(v),onSuccess:()=>{g(),o("Account created successfully","SUCCESS"),r("/notice-email?type=verify-account",{state:{from:l.pathname}})},onError:v=>{var Q,P;o(((P=(Q=v==null?void 0:v.response)==null?void 0:Q.data)==null?void 0:P.msg)||(v==null?void 0:v.message),"ERROR")}}),S=u(v=>{const{confirmPassword:Q,...P}=v;j(P)});return{register:d,errors:y,watch:p,trigger:f,isPwdVisible:s,isConfirmPwdVisible:a,handleChangePwdVisibility:i,handleChangeConfirmPwdVisibility:c,isPending:_,handleRegister:S,customPwd:v=>v===p("email")?"Password must be different from email":!0,customConfirmPwd:v=>v!==p("password")?"Passwords do not match 🤔":!0}},ls=({watch:s})=>{const t=s("password"),a=(t==null?void 0:t.length)>=8;return e.jsxs("div",{className:"w-full col-span-2 grid grid-cols-[35px_70px_1fr] items-center",children:[e.jsx("span",{children:a?e.jsx(ve,{className:"w-[30px] h-[30px] text-green-600"}):e.jsx(Ze,{className:"w-[30px] h-[30px] text-red-600"})}),e.jsx("span",{className:`txt__00 ml-2 px-3 py-1 border-2 rounded-xl ${a?"text-green-600 border-green-600":"text-red-600 border-red-600"}`,children:e.jsx(Kt,{})}),e.jsxs("span",{className:`txt__01 ml-4 ${a?"text-green-600":"text-red-600"}`,children:[(t==null?void 0:t.length)??0," / 8"]})]})},is=({watch:s})=>Bn.map(t=>{const a=le(s("password"),t.reg);return e.jsxs("div",{className:"w-full grid grid-cols-[35px_70px_1fr] items-center",children:[e.jsx("span",{children:a?e.jsx(ve,{className:"w-[30px] h-[30px] text-green-600"}):e.jsx(Ze,{className:"w-[30px] h-[30px] text-red-600"})}),e.jsx("span",{className:`txt__00 ml-2 px-3 py-1 border-2 rounded-xl ${a?"text-green-600 border-green-600":"text-red-600 border-red-600"}`,children:t.label}),e.jsx("span",{className:`txt__00 hidden ml-4 ${a?"text-green-600":"text-red-600"}`,children:t.msg})]},t.id)}),_r=()=>{const[s,t]=m.useState(""),a=m.useRef(null);m.useEffect(()=>{const o=d=>{var u;if(a.current&&(u=a.current)!=null&&u.contains(d.target)){const g=document.getElementById("tooltip");g==null||g.classList.remove("generate_password__tooltip"),requestAnimationFrame(()=>g==null?void 0:g.classList.add("generate_password__tooltip"))}};return document.addEventListener("click",o),()=>document.removeEventListener("click",o)},[]);const n="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*()_+{}[]<>-+~/$\\|",r=()=>{const o=n.split("");for(let d=o.length-1;d>0;d--){const u=Math.floor(Math.random()*(d+1));[o[d],o[u]]=[o[u],o[d]]}return o.join("")},l=()=>{const o=new Uint8Array(24);window.crypto.getRandomValues(o);const d=r();return Array.from(o,u=>d[u%d.length]).join("")};return{generatePwd:async()=>{let o="";for(;!Us.test(o);)o=await l();t(o)},handleCopyPwd:async()=>{if(s)try{await navigator.clipboard.writeText(s)}catch{}},strongPwd:s,tooltipRef:a}},os=()=>{const{strongPwd:s,generatePwd:t,handleCopyPwd:a,tooltipRef:n}=_r();return e.jsxs("div",{className:"w-full max-w-full grid grid-cols-1 gap-3",children:[e.jsx("div",{className:"w-full max-w-fit flex hover:text-orange-500 btn__pseudo",children:e.jsxs("button",{onClick:t,type:"button",className:"justify-self-start flex gap-4 items-center cursor-pointer",children:[e.jsx(Xt,{className:"w-[30px] h-[30px]"}),e.jsx("span",{className:"txt__00",children:"Generate strong password"})]})}),!!s&&e.jsxs("div",{className:"relative group w-full flex max-w-fit",children:[e.jsx("button",{type:"button",ref:n,onClick:a,className:"txt__00 btn__pseudo border-2 border-orange-500 rounded-xl w-full max-w-fit px-6 py-1 cursor-pointer hover:text-orange-500 break-all text-start",children:s}),e.jsx("span",{id:"tooltip",className:"absolute text-sm lg:text-base px-4 py-1 -top-1/2 left-1/2 border-2 border-orange-500 rounded-xl w-full whitespace-nowrap bg-[#111] pointer-events-none z-10 txt__00 max-w-fit px-6 min-w-[150px] opacity-0",children:"Password Copied"})]})]})},vr=()=>{const{register:s,errors:t,watch:a,isPwdVisible:n,isConfirmPwdVisible:r,handleChangePwdVisibility:l,handleChangeConfirmPwdVisibility:i,isPending:c,handleRegister:o,customPwd:d,customConfirmPwd:u}=br();return e.jsxs("div",{className:"w-full grid grid-cols-1 gap-y-10 items-center",children:[e.jsx("div",{className:"w-full flex justify-center",children:e.jsx("span",{className:"txt__04",children:"Register"})}),e.jsx("div",{className:"w-full justify-self-center max-w-[600px] grid grid-cols-1 border-2 border-orange-500 rounded-xl p-10",children:e.jsx("div",{className:"w-full grid grid-cols-1",children:e.jsxs("form",{onSubmit:o,className:"grid grid-cols-1 w-full gap-y-8",children:[[...Kn,ye].map(g=>e.jsx(fe,{register:s,errors:t,field:g},g.id)),e.jsx(se,{register:s,errors:t,custom:d,isVisible:n,handleChangeVisibility:l,field:ts}),e.jsx(os,{}),!!Object.keys((t==null?void 0:t.password)??{}).length&&e.jsxs("div",{className:"w-full grid grid-cols-2 gap-5 sm:grid-cols-4",children:[e.jsx(is,{watch:a}),e.jsx(ls,{watch:a})]}),e.jsx(se,{register:s,errors:t,custom:u,isVisible:r,handleChangeVisibility:i,field:as}),e.jsx(jr,{register:s,errors:t,valTerms:a("acceptedTerms")}),e.jsx("div",{className:"w-full mt-2 max-w-[225px] md:max-w-[250px] justify-self-center flex justify-center",children:e.jsx(G,{styleTxt:"txt__02",label:"Register",type:"submit",isPending:c})}),e.jsx("div",{className:"w-full",children:e.jsx(Js,{type:"register"})})]})})})]})},Nr=({reset:s,callAPI:t,type:a,from:n})=>{const{showToastMsg:r}=R(),{handleErrAPI:l}=I(),i=C(),{mutate:c,isPending:o}=E({mutationFn:({email:d})=>t({email:d,type:a}),onSuccess:()=>{s(),r("Verification Email sent successfully","SUCCESS"),i(`/notice-email?type=${a??""}`,{state:{from:n}})},onError:d=>{var u,g,p;((u=d==null?void 0:d.response)==null?void 0:u.status)===403?r((p=(g=d==null?void 0:d.response)==null?void 0:g.data)==null?void 0:p.msg,"ERROR"):l({err:d})}});return{mutate:c,isPending:o}},Sr=()=>{var f;F();const[s]=Z(),t=D(),a=(f=t==null?void 0:t.state)==null?void 0:f.from,n=s.get("type"),r=ce(["/auth/register","/auth/login"],a)&&ce(["recover-pwd","verify-account"],n??""),{register:l,handleSubmit:i,formState:{errors:c},reset:o,setFocus:d}=M({mode:"onChange"});m.useEffect(()=>{d("email")},[d]);const{mutate:u,isPending:g}=Nr({reset:o,callAPI:sn,from:a,type:n}),p=i(y=>{u({email:y.email})});return{register:l,errors:c,canStay:r,type:n,isPending:g,handleSubmitEmail:p}},Pr=()=>{const{register:s,errors:t,canStay:a,type:n,isPending:r,handleSubmitEmail:l}=Sr();return a?e.jsxs("div",{className:"w-full grid grid-cols-1 gap-y-10 items-center",children:[e.jsx("div",{className:"w-full flex justify-center",children:e.jsx("span",{className:"txt__04",children:n==="recover-pwd"?"Recover Password":"Verify Account"})}),e.jsx("div",{className:"w-full justify-self-center max-w-[600px] grid grid-cols-1 border-2 border-orange-500 rounded-xl p-10",children:e.jsx("div",{className:"w-full grid grid-cols-1",children:e.jsxs("form",{onSubmit:l,className:"grid grid-cols-1 w-full gap-y-8",children:[e.jsx(fe,{register:s,errors:t,field:ye}),e.jsx("div",{className:"w-full mt-2 max-w-[225px] md:max-w-[250px] justify-self-center flex justify-center",children:e.jsx(G,{styleTxt:"txt__02",label:"Send Email",type:"submit",isPending:r})})]})})})]}):e.jsx(U,{to:"/",replace:!0})},gs=({callAPI:s,successCB:t})=>{const a=C(),{handleErrAPI:n}=I(),{showToastMsg:r}=R(),l=c=>{var o,d,u,g,p,f,y;((o=c==null?void 0:c.response)==null?void 0:o.status)===401&&["VERIFY TOKEN EXPIRED"].includes((u=(d=c==null?void 0:c.response)==null?void 0:d.data)==null?void 0:u.msg)?(((p=(g=c==null?void 0:c.response)==null?void 0:g.config)==null?void 0:p.url)==="/auth/verify-account"?a("/auth/send-email?type=verify-account",{replace:!0,state:{from:"/auth/register"}}):a("/auth/send-email?type=recover-pwd",{replace:!0,state:{from:"/auth/login"}}),r((y=(f=c==null?void 0:c.response)==null?void 0:f.data)==null?void 0:y.msg,"ERROR")):n({err:c,push:!0})},{mutate:i}=E({mutationFn:({userId:c,token:o})=>s({userId:c,token:o}),onSuccess:c=>{t(c)},onError:c=>{l(c)}});return{mutate:i}},Er=()=>{const s=m.useRef(!1),{isLogged:t,setUserLogged:a}=$(),{showToastMsg:n}=R();F();const[r]=Z(),l=C(),i=r.get("type"),c=r.get("token"),o=r.get("userId"),d=le(o??"",W),u=le(c??"",Ce),g=ce(["recover-pwd","verify-account"],i??""),p=[u,d,g].every(_=>!!_)&&!t,f=_=>{a(_.accessToken),n("Account Verified Successfully","SUCCESS"),l("/",{replace:!0})},{mutate:y}=gs({callAPI:({userId:_,token:S})=>tn({userId:_,token:S}),successCB:_=>f(_)}),x=()=>{n("Email verified Successfully","SUCCESS"),l(`/auth/recover-pwd?userId=${o}&token=${c}`,{state:{from:"/auth/verify"},replace:!0})},{mutate:w}=gs({callAPI:({userId:_,token:S})=>an({userId:_,token:S}),successCB:()=>x()}),j=m.useCallback(()=>{s.current||(s.current=!0,i==="verify-account"?(y({userId:o,token:c}),console.log("run")):i==="recover-pwd"&&w({userId:o,token:c}))},[y,w,i,c,o]);return m.useEffect(()=>{j()},[j]),{canStay:p}},ee={sm:640,md:768,lg:1024,xl:1280,_2xl:1536},Cr=()=>{const[s,t]=m.useState(35),a=360/s;return m.useEffect(()=>{const n=()=>window.innerWidth>ee.lg?t(40):t(30);return window.addEventListener("resize",n),()=>window.removeEventListener("resize",n)},[]),{numEls:s,deg:a}},Rr=()=>{const{numEls:s,deg:t}=Cr();return e.jsx("div",{className:"w-[200px] h-[200px] lg:h-[300px] lg:w-[300px] relative",children:Array.from({length:s}).map((a,n)=>e.jsx("span",{className:" spinner__el absolute top-1/2 left-1/2 -translate-y-1/2 -translate-x-1/2 min-w-full min-h-full",style:{"--i":n,"--numEls":s,"--deg":`${t}deg`,transform:`rotate(${t*n}deg)`}},n))})},Y=({pad:s})=>e.jsx("div",{className:`w-full flex justify-center items-center ${s??"pt-[20vw] lg:pt-[12.5vw]"}`,children:e.jsx(Rr,{})}),Ir=()=>{const{canStay:s}=Er();return s?e.jsx(Y,{}):e.jsx(U,{to:"/",replace:!0})},Ar=()=>{var oe;const[s,t]=m.useState(!1),[a,n]=m.useState(!1),{handleErrAPI:r}=I(),{showToastMsg:l}=R(),{setUserLogged:i}=$();F();const c=D(),o=C(),[d]=Z(),u=d.get("token"),g=d.get("userId"),p=W.test(g??""),f=Ce.test(u??""),y=((oe=c==null?void 0:c.state)==null?void 0:oe.from)==="/auth/verify"&&p&&f;console.log(c.state.from);const{handleChangePwdVisibility:x,handleChangeConfirmPwdVisibility:w}=rs({isPwdVisible:s,setIsPwdVisible:t,isConfirmPwdVisible:a,setIsConfirmPwdVisible:n}),{register:j,setFocus:_,formState:{errors:S},handleSubmit:T,reset:A,watch:v,trigger:Q}=M({mode:"onChange"}),{mutate:P,isPending:K}=E({mutationFn:({password:L,token:ne,userId:B})=>nn({password:L,token:ne,userId:B}),onSuccess:L=>{A(),i(L==null?void 0:L.accessToken),l("Password changed successfully","SUCCESS"),o("/",{replace:!0})},onError:L=>{r({err:L})}}),J=T(L=>{const{password:ne}=L;P({password:ne,token:u,userId:g})}),k=v("password");return m.useEffect(()=>{_("password")},[_]),m.useEffect(()=>{k&&Q("confirmPassword")},[k,Q]),{register:j,errors:S,watch:v,isPwdVisible:s,isConfirmPwdVisible:a,handleChangePwdVisibility:x,handleChangeConfirmPwdVisibility:w,canStay:y,handleSubmitRecoverPwd:J,isPending:K,customConfirmPwd:L=>L!==v("password")?"Passwords do not match 🤔":!0}},Dr=()=>{const{register:s,errors:t,watch:a,isPwdVisible:n,isConfirmPwdVisible:r,handleChangePwdVisibility:l,handleChangeConfirmPwdVisibility:i,canStay:c,isPending:o,handleSubmitRecoverPwd:d,customConfirmPwd:u}=Ar();return c?e.jsxs("div",{className:"w-full grid grid-cols-1 gap-y-10 items-center",children:[e.jsx("div",{className:"w-full flex justify-center",children:e.jsx("span",{className:"txt__04",children:"Recover Password"})}),e.jsx("div",{className:"w-full justify-self-center max-w-[600px] grid grid-cols-1 border-2 border-orange-500 rounded-xl p-10",children:e.jsx("div",{className:"w-full grid grid-cols-1",children:e.jsxs("form",{onSubmit:d,className:"grid grid-cols-1 w-full gap-y-8",children:[e.jsx(se,{register:s,errors:t,isVisible:n,handleChangeVisibility:l,field:ts}),!!Object.keys((t==null?void 0:t.password)??{}).length&&e.jsxs("div",{className:"w-full grid grid-cols-2 gap-5 sm:grid-cols-4",children:[e.jsx(is,{watch:a}),e.jsx(ls,{watch:a})]}),e.jsx(os,{}),e.jsx(se,{register:s,errors:t,custom:u,isVisible:r,handleChangeVisibility:i,field:as}),e.jsx("div",{className:"w-full mt-2 max-w-[250px] md:max-w-[300px] justify-self-center flex justify-center",children:e.jsx(G,{styleTxt:"txt__02",label:"Change Password",type:"submit",isPending:o})})]})})})]}):e.jsx(U,{to:"/",replace:!0})};var O=(s=>(s.UPDATE_FIELD="UPDATE_FIELD",s.SET_ERR="SET_ERR",s.SET_REQUIRED="SET_REQUIRED",s.SET_PREV_DISABLED="SET_PREV_DISABLED",s.SET_NEXT_DISABLED="SET_NEXT_DISABLED",s.SET_CURR="SET_CURR",s.SET_FETCHED_DATA="SET_FETCHED_DATA",s))(O||{});const Fr=(s,t)=>{var a,n,r,l,i,c;switch(t.type){case O.UPDATE_FIELD:{const{field:o,val:d}=t.payload;return{...s,user:{...s.user,[o]:d}}}case O.SET_ERR:{const{field:o,msg:d}=t.payload;return{...s,errs:{...s.errs,[o]:{...s.errs[o],msg:d}}}}case O.SET_REQUIRED:{const{field:o,required:d}=t.payload;return{...s,errs:{...s.errs,[o]:{...s.errs[o],required:d}}}}case O.SET_CURR:{const{curr:o}=t.payload;return o==="PREV"&&!s.currForm.isPrevDisabled?{...s,currForm:{curr:s.currForm.curr-1,isPrevDisabled:s.currForm.curr-1===0,isNextDisabled:!1}}:{...s,currForm:{curr:s.currForm.curr+1,isPrevDisabled:!1,isNextDisabled:s.currForm.curr+1===es-1}}}case O.SET_NEXT_DISABLED:{const{isNextDisabled:o}=t.payload;return{...s,currForm:{...s.currForm,isNextDisabled:o}}}case O.SET_FETCHED_DATA:{const{user:o}=t.payload;return{...s,user:{firstName:(o==null?void 0:o.firstName)??"",lastName:(o==null?void 0:o.lastName)??"",country:((a=o==null?void 0:o.address)==null?void 0:a.country)??"",state:((n=o==null?void 0:o.address)==null?void 0:n.state)??"",city:((r=o==null?void 0:o.address)==null?void 0:r.city)??"",street:((l=o==null?void 0:o.address)==null?void 0:l.street)??"",zipCode:((i=o==null?void 0:o.address)==null?void 0:i.zipCode)??"",phone:((c=o==null?void 0:o.address)==null?void 0:c.phone)??""},errs:{}}}default:return s}},Tr=(s,t)=>{let a;for(const n in t)s.map(r=>r.field).includes(n)&&(a={...a,[n]:t[n]});return a},kr=(s,t)=>{let a=!0;for(let n=0;n<t.length;n++)t[n].reg.test(s[t[n].field])||(a=!1);return a},Lr=(s,t,a,n)=>{s({type:O.SET_ERR,payload:{field:t,msg:n.reg.test(a??"")?null:n.msg}}),s({type:O.SET_REQUIRED,payload:{field:t,required:a?null:`${n.label} is required`}})},Mr=(s,t,a,n,r)=>{const l=Mn[r??t.currForm.curr],i=Tr(l,t.user);a!==void 0&&n!==void 0&&(i[a]=n);const c=kr(i,l);s({type:O.SET_NEXT_DISABLED,payload:{isNextDisabled:!c}})},Ur=(s,t,a,n)=>{const{name:r,value:l}=n.target,[i]=Ln.filter(c=>c.field===r);t(r,l,i),a(r,l),s({type:O.UPDATE_FIELD,payload:{field:r,val:l}})},$r=(s,t)=>t>0?s({type:O.SET_CURR,payload:{curr:"PREV"}}):void 0,Vr=(s,t,a)=>{t.curr<es-1&&!t.isNextDisabled&&s({type:O.SET_CURR,payload:{curr:"NEXT"}}),a(void 0,void 0,t.curr+1)},Or=(s,t)=>s({type:O.SET_FETCHED_DATA,payload:{user:t}}),Br={currForm:{curr:0,isPrevDisabled:!0,isNextDisabled:!1},user:{firstName:"",lastName:"",country:"",state:"",city:"",street:"",zipCode:"",phone:""},errs:{}},qr=()=>{const{handleErrAPI:s}=I(),{showToastMsg:t}=R(),a=Ne(),{data:n,isPending:r,isError:l,isSuccess:i,error:c}=ae({queryKey:["userProfileDetails"],queryFn:Ta}),{mutate:o,isPending:d,isSuccess:u,isError:g,error:p}=E({mutationFn:P=>ka(P)}),[f,y]=m.useReducer(Fr,Br),x=m.useCallback(P=>Or(y,P),[y]),w=m.useCallback(()=>{if(l)s({err:c});else if(i){const{user:P={}}=n??{};x(P)}},[n,i,l,c,s,x]),j=m.useCallback(async()=>{g?s({err:p}):u&&(t("Profile updated successfully","SUCCESS"),await a.invalidateQueries({queryKey:["userProfileDetails"]}))},[a,g,s,p,u,t]);m.useEffect(()=>{w()},[w]),m.useEffect(()=>{j()},[j]);const _=(P,K,J)=>Lr(y,P,K,J),S=(P,K,J)=>Mr(y,f,P,K,J);return{state:f,handleChangeHigher:P=>Ur(y,_,S,P),handlePrevHigher:()=>$r(y,f.currForm.curr),handleNextHigher:()=>Vr(y,f.currForm,S),isPending:r,isPendingUpdate:d,handleSubmit:P=>{P.preventDefault(),o({...f.user})}}},zr=()=>{const s=m.useRef(null),t=m.useRef(null),a=m.useRef(null),{state:n,handleChangeHigher:r,handlePrevHigher:l,handleNextHigher:i,isPending:c,isPendingUpdate:o,handleSubmit:d}=qr();F(),m.useEffect(()=>{(()=>{const y=[s,t,a],x=n.currForm.curr;y[x].current&&setTimeout(()=>{var w;(w=y[x].current)==null||w.focus()},600)})()},[n.currForm.curr]);const{isPrevDisabled:u,isNextDisabled:g,curr:p}=n.currForm;return{isPrevDisabled:u,isNextDisabled:g,handleNext:i,handlePrev:l,curr:p,state:n,handleChange:r,isPending:c,isPendingUpdate:o,handleSubmit:d,inputRef_0:s,inputRef_1:t,inputRef_2:a}},te=({isDisabled:s,label:t,type:a="button",handleClick:n,styleTxt:r,styleBtn:l,isPending:i})=>i?e.jsx(Pe,{}):e.jsxs("button",{disabled:s,onClick:n,type:a,className:"btn__with_shadow_container group",children:[e.jsx("div",{className:`${l??"group-hover:text-orange-500"} btn__with_shadow_container__content`,children:e.jsx("span",{className:`${r} content__txt`,children:t})}),e.jsx("span",{className:`${l??"group-hover:text-orange-500"} btn__with_shadow_container__shadow`})]}),Ae=({currForm:s,isPrevDisabled:t,isNextDisabled:a,handlePrev:n,handleNext:r,totLen:l,hiddenLg:i,children:c=!1})=>e.jsxs("div",{className:`w-full grid grid-cols-2 sm:justify-items-center ${i?"lg:hidden":""}`,children:[e.jsx("div",{className:"w-full max-w-[30vw] sm:max-w-[200px] justify-self-start sm:justify-self-center",children:e.jsx(te,{label:"Prev",isDisabled:t,handleClick:n,styleTxt:"txt__02",type:"button"})}),s===l-1?c??null:e.jsx("div",{className:"w-full max-w-[30vw] sm:max-w-[200px] justify-self-end sm:justify-self-center",children:e.jsx(te,{label:"Next",isDisabled:a,handleClick:r,styleTxt:"txt__02",type:"button"})})]}),Gr=({isPrevDisabled:s,isNextDisabled:t,handlePrev:a,handleNext:n,curr:r,isPendingUpdate:l})=>e.jsx(Ae,{isPrevDisabled:s,isNextDisabled:t,handleNext:n,handlePrev:a,currForm:r,totLen:es,hiddenLg:!1,children:e.jsx("div",{className:"w-full max-w-[200px] h-full flex items-center",children:e.jsx(G,{label:"Save",isDisabled:t,type:"submit",styleTxt:"txt__02",isPending:l})})}),Fe=({el:s,state:t,handleChange:a,inputRef:n})=>{var l;const r=(l=t.errs)==null?void 0:l[s.field];return e.jsxs("label",{className:"w-full flex flex-col gap-y-2",children:[e.jsx("span",{className:"txt__02",children:s.label}),e.jsx("input",{ref:n,onChange:a,type:"text",className:"w-full outline-none px-5 py-1 txt__01 border-2 border-orange-500 rounded-full focus__base el__flow",placeholder:`${s.label}`,name:s.field,value:t.user[s.field]}),!!Object.keys(r??{}).length&&e.jsx("span",{className:"txt__00 text-red-600",children:(r==null?void 0:r.required)||(r==null?void 0:r.msg)||""})]},s.id)},Qr=({state:s,handleChange:t,inputRef_0:a,inputRef_1:n,inputRef_2:r})=>e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 p-5 gap-y-5 h-fit transition-all duration-500",children:Je.map((l,i)=>e.jsx(Fe,{state:s,handleChange:t,el:l,inputRef:s.currForm.curr===0&&i===0?a:null},l.id))}),e.jsx("div",{className:"min-w-full grid grid-cols-1 p-5 gap-y-5 transition-all duration-500 h-fit ",children:Re.map((l,i)=>e.jsx(Fe,{state:s,handleChange:t,el:l,inputRef:s.currForm.curr===1&&i===0?n:null},l.id))}),e.jsx("div",{className:"min-w-full grid grid-cols-1 p-5 gap-y-5 transition-all duration-500 h-fit ",children:Ie.map((l,i)=>e.jsx(Fe,{state:s,handleChange:t,el:l,inputRef:s.currForm.curr===2&&i===0?r:null},l.id))})]}),Hr=()=>{const{isPrevDisabled:s,isNextDisabled:t,handleNext:a,handlePrev:n,curr:r,state:l,handleChange:i,isPending:c,isPendingUpdate:o,handleSubmit:d,inputRef_0:u,inputRef_1:g,inputRef_2:p}=zr();return e.jsxs("div",{className:"w-full grid grid-cols-1 justify-items-center gap-y-5",children:[e.jsx("span",{className:"txt__04",children:"Your Profile Details"}),c?e.jsx(Y,{}):e.jsxs("form",{onSubmit:d,className:"w-full max-w-[600px] justify-self-center grid grid-cols-1 border-[3px] gap-5 border-orange-500 rounded-xl h-fit p-5 sm:px-10",children:[e.jsx("div",{className:"w-full overflow-hidden",children:e.jsx("div",{className:"w-[300%] grid grid-cols-3 transition-all duration-500 min-h-[250px]",style:{transform:`translateX(-${r*100/3}%)`},children:e.jsx(Qr,{state:l,handleChange:i,inputRef_0:u,inputRef_1:g,inputRef_2:p})})}),e.jsx(Gr,{isPrevDisabled:s,isNextDisabled:t,handlePrev:n,handleNext:a,curr:r,isPendingUpdate:o})]})]})},Yr=()=>{F();const[s]=Z(),t=C(),a=D(),{showToastMsg:n}=R(),{handleErrAPI:r}=I(),l=s.get("typeUser"),i=s.get("userId"),c=s.get("token"),o=ce(["non-logged","logged"],l??"")&&le(c??"",Ce)&&le(i??"",W),d={userId:i??"",token:c??""},{mutate:u}=E({mutationFn:()=>l==="logged"?qa({...d}):za({...d}),onSuccess:()=>{t("/newsletter/notice-unsubscribe-with-retry?success=true",{state:{from:a.pathname},replace:!0}),n("Subscription deleted successfully","SUCCESS")},onError:g=>{var p,f,y;((p=g==null?void 0:g.response)==null?void 0:p.status)===401?(t("/newsletter/notice-unsubscribe-with-retry?success=false",{state:{from:a.pathname},replace:!0}),n((y=(f=g==null?void 0:g.response)==null?void 0:f.data)==null?void 0:y.msg,"ERROR")):r({err:g,push:!0})}});return m.useEffect(()=>{o&&u()},[o,u]),{canStay:o}},Zr=()=>{const{canStay:s}=Yr();return s?e.jsx(Y,{}):e.jsx(U,{to:"/",replace:!0})},Wr=()=>{var y;const{showToastMsg:s}=R(),{handleErrAPI:t}=I();F();const[a]=Z(),n=D(),r=C(),l=a.get("success"),i=((y=n==null?void 0:n.state)==null?void 0:y.from)==="/newsletter/verify-unsubscribe",{register:c,formState:{errors:o},handleSubmit:d,reset:u}=M({mode:"onChange"}),{mutate:g,isPending:p}=E({mutationFn:({email:x})=>Ga({email:x}),onSuccess:()=>{u(),s("Email sent successfully","SUCCESS"),r("/notice-email?type=sentEmailUnsubscribe",{state:{from:n.pathname}})},onError:x=>{t({err:x})}}),f=d(x=>{g({email:x.email})});return{canStay:i,success:l,register:c,errors:o,handleSubmitEmail:f,isPending:p}},Kr=()=>{const{canStay:s,success:t,register:a,errors:n,handleSubmitEmail:r,isPending:l}=Wr();return s?t==="true"?e.jsxs("div",{className:"w-full flex flex-col items-center gap-y-14",children:[e.jsx("div",{className:"w-full flex justify-center",children:e.jsx("span",{className:"txt__04 leading-10 lg:leading-16",children:"Your subscription has deleted successfully, if you unsubscribe by mistake don't worry, you can subscribe again anytime ✌🏼"})}),e.jsx("div",{className:"w-full flex justify-center items-center",children:e.jsx(ve,{className:"w-[200px] sm:w-[300px] h-[200px] sm:h-[300px] md:w-[400px] md:h-[400px] text-green-600"})})]}):e.jsxs("div",{className:"w-full grid grid-cols-1 gap-y-10 items-center",children:[e.jsx("div",{className:"w-full flex justify-center",children:e.jsx("span",{className:"txt__04",children:"Send unsubscribe link"})}),e.jsx("div",{className:"w-full justify-self-center max-w-[600px] grid grid-cols-1 border-2 border-orange-500 rounded-xl p-10",children:e.jsx("div",{className:"w-full grid grid-cols-1",children:e.jsxs("form",{onSubmit:r,className:"grid grid-cols-1 w-full gap-y-8",children:[e.jsx(fe,{register:a,errors:n,field:ye}),e.jsx("div",{className:"w-full mt-2 max-w-[225px] md:max-w-[250px] justify-self-center flex justify-center",children:e.jsx(G,{styleTxt:"txt__02",label:"Send Email",type:"submit",isPending:l})})]})})})]}):e.jsx(U,{to:"/",replace:!0})},Xr=()=>{F();const{showToastMsg:s,closeToast:t}=R(),{handleErrAPI:a}=I(),{setCanManageAccount:n,canManageAccount:r,currUser:l,logoutUser:i}=$();return{showToastMsg:s,canManageAccount:r,setCanManageAccount:n,currUser:l,handleErrManageUser:({err:o})=>{var p,f,y,x,w;const d=(p=o==null?void 0:o.response)==null?void 0:p.status,u=(y=(f=o==null?void 0:o.response)==null?void 0:f.config)==null?void 0:y.url,g=((w=(x=o==null?void 0:o.response)==null?void 0:x.data)==null?void 0:w.msg)||o.message;u==="/user/manage-account"?d===401?s(g,"ERROR"):d===429&&(i(),a({err:o})):([401,429].includes(d??400)&&n(!1),a({err:o}))},closeToast:t}},Jr=({setCanManageAccount:s,handleErrManageUser:t,closeToast:a})=>{const[n,r]=m.useState(!1),l=()=>r(!n),{register:i,formState:{errors:c},handleSubmit:o,setFocus:d}=M({mode:"onChange"});m.useEffect(()=>{d("password")},[d]);const{mutate:u,isPending:g}=E({mutationFn:f=>La(f),onSuccess:f=>{s(f.manageAccountToken),a()},onError:f=>{t({err:f})}}),p=o(f=>{u(f.password)});return{register:i,errors:c,isPwdVisible:n,handleChangeVisibility:l,submitManageForm:p,isPending:g}},el=({setCanManageAccount:s,handleErrManageUser:t,closeToast:a})=>{const{register:n,errors:r,isPwdVisible:l,handleChangeVisibility:i,submitManageForm:c,isPending:o}=Jr({setCanManageAccount:s,handleErrManageUser:t,closeToast:a});return e.jsxs("form",{onSubmit:c,className:"w-full max-w-[600px] justify-self-center grid grid-cols-1 border-[3px] gap-10 border-orange-500 rounded-xl h-fit p-5 sm:px-10 justify-items-center",children:[e.jsx("span",{className:"txt__03",children:"Confirm your password before proceeding"}),e.jsx("div",{className:"w-full",children:e.jsx(se,{field:ss,register:n,errors:r,isVisible:l,handleChangeVisibility:i})}),e.jsx("div",{className:"w-full flex max-w-[200px] sm:max-w-[250px] justify-center",children:e.jsx(te,{label:"Submit",styleTxt:"txt__02",type:"submit",isPending:o})})]})},sl=({showToastMsg:s,setIsChildLoading:t,handleErrManageUser:a})=>{const n=D(),r=C(),{register:l,formState:{errors:i},handleSubmit:c,setFocus:o}=M({mode:"onChange"});m.useEffect(()=>{o("newEmail")},[o]);const{mutate:d,isPending:u}=E({mutationFn:f=>(t(!0),Ma(f)),onSuccess:()=>{s("Email changed successfully!","SUCCESS"),r("/notice-email?type=change-email",{state:{from:n.pathname}})},onError:f=>{a({err:f})},onSettled:()=>{t(!1)}}),g=c(f=>{d({newEmail:f.newEmail,manageAccountToken:sessionStorage.getItem("manageAccountToken")??""})});return{register:l,errors:i,handleSubmitChangeEmail:g,isPending:u,custom:(f,y)=>f===y?"New Email must be different from old one":!0}},tl=({currUser:s,showToastMsg:t,setIsChildLoading:a,handleErrManageUser:n})=>{const{register:r,errors:l,handleSubmitChangeEmail:i,isPending:c,custom:o}=sl({showToastMsg:t,setIsChildLoading:a,handleErrManageUser:n});return e.jsxs("div",{className:"w-full grid grid-cols-1 justify-items-center gap-y-5 py-5 px-5 sm:px-10 h-[300px]",children:[e.jsx("span",{className:"txt__03",children:"Change Email"}),e.jsxs("form",{onSubmit:i,className:"w-full grid grid-cols-1 justify-items-center gap-y-6",children:[e.jsx("div",{className:"w-full",children:e.jsx(fe,{register:r,errors:l,field:Wn,custom:d=>o(d,s==null?void 0:s.email)})}),e.jsx("div",{className:"w-full flex justify-center max-w-[250px]",children:e.jsx(G,{styleTxt:"txt__02",label:"Submit",type:"submit",isPending:c})})]})]})},Me=3,al=()=>{const[s,t]=m.useState(0),[a,n]=m.useState(!1),r=s===0,l=s===Me-1;return{currForm:s,handlePrev:()=>s>0?t(o=>o-1):void 0,handleNext:()=>s<Me-1?t(o=>o+1):void 0,isPrevDisabled:r,isNextDisabled:l,isChildLoading:a,setIsChildLoading:n}},nl=({showToastMsg:s,handleErrManageUser:t,setIsChildLoading:a,setCanManageAccount:n})=>{const[r,l]=m.useState(!1),[i,c]=m.useState(!1),o=C(),{register:d,watch:u,reset:g,formState:{errors:p},handleSubmit:f}=M({mode:"onChange"}),{handleChangePwdVisibility:y,handleChangeConfirmPwdVisibility:x}=rs({isConfirmPwdVisible:i,setIsConfirmPwdVisible:c,isPwdVisible:r,setIsPwdVisible:l}),{mutate:w,isPending:j}=E({mutationFn:A=>(a(!0),$a(A)),onSuccess:()=>{g(),s("Password changed successfully","SUCCESS"),o("/")},onError:A=>{t({err:A})},onSettled:()=>{a(!1),n(!1)}}),_=f(A=>{const{newPassword:v}=A;w({newPassword:v,manageAccountToken:sessionStorage.getItem("manageAccountToken")??""})});return{register:d,errors:p,watch:u,handleChangePwdVisibility:y,handleChangeConfirmPwdVisibility:x,isConfirmPwdVisible:i,isPwdVisible:r,customPwd:(A,v)=>A===v?"Password must be different from email":!0,customConfirmPwd:A=>A!==u("newPassword")?"Passwords do not match 🤔":!0,isPending:j,handleSubmitChangePwd:_}},rl=({showToastMsg:s,handleErrManageUser:t,setIsChildLoading:a,currUser:n,setCanManageAccount:r})=>{const{register:l,errors:i,watch:c,handleChangePwdVisibility:o,handleChangeConfirmPwdVisibility:d,isConfirmPwdVisible:u,isPwdVisible:g,customPwd:p,customConfirmPwd:f,isPending:y,handleSubmitChangePwd:x}=nl({showToastMsg:s,handleErrManageUser:t,setIsChildLoading:a,setCanManageAccount:r});return e.jsxs("div",{className:"w-full grid grid-cols-1 justify-items-center gap-y-5 py-5 pb-10 px-5 sm:px-10",children:[e.jsx("span",{className:"txt__03",children:"Change Password"}),e.jsxs("form",{onSubmit:x,className:"w-full grid grid-cols-1 justify-items-center gap-y-5",children:[e.jsx("div",{className:"w-full",children:e.jsx(se,{field:Xn,register:l,errors:i,isVisible:g,handleChangeVisibility:o,custom:w=>p(w,n==null?void 0:n.email)})}),!!Object.keys((i==null?void 0:i.newPassword)??{}).length&&e.jsxs("div",{className:"w-full grid grid-cols-2 sm:grid-cols-3 gap-3",children:[e.jsx(is,{watch:c}),e.jsx(ls,{watch:c})]}),e.jsx(os,{}),e.jsx("div",{className:"w-full",children:e.jsx(se,{field:as,register:l,errors:i,isVisible:u,handleChangeVisibility:d,custom:f})}),e.jsx("div",{className:"w-full flex justify-center max-w-[250px] mt-5",children:e.jsx(G,{styleTxt:"txt__02",label:"Submit",type:"submit",isPending:y})})]})]})},ie=({handleDelete:s,txt:t,border:a=!0})=>e.jsx("button",{onClick:s,className:`max-w-fit group ${a?"border-2 border-red-600 ":""}el__flow hover:scale-110 rounded-xl gap-3 cursor-pointer`,children:e.jsxs("div",{className:"px-4 pr-6 py-2 w-full flex justify-start gap-3 items-center",children:[e.jsx(ze,{className:"w-[30px] h-[30px] el__flow group-hover:text-red-600"}),e.jsx("span",{className:"txt__02 el__flow group-hover:text-red-600",children:t})]})}),ll=({showToastMsg:s,setIsChildLoading:t,handleErrManageUser:a})=>{const n=C(),{logoutUser:r}=$(),{setPopup:l,popup:i}=pe(),{mutate:c,isPending:o}=E({mutationFn:g=>(t(!0),l({...i,isPending:!0}),Va(g)),onSuccess:()=>{n("/",{replace:!0}),r(),s("Account deleted successfully","SUCCESS")},onError:g=>{a({err:g})},onSettled:()=>{l(null),t(!1)}}),d=()=>{c(sessionStorage.getItem("manageAccountToken")??"")};return{handleSubmitDeleteAccount:()=>{l({txt:"delete your account?",redLabel:"Delete account",isPending:o,confirmAction:d})},isPending:o,handleDeleteAccount:d}},il=({showToastMsg:s,setIsChildLoading:t,handleErrManageUser:a})=>{const{handleSubmitDeleteAccount:n}=ll({showToastMsg:s,setIsChildLoading:t,handleErrManageUser:a});return e.jsxs("div",{className:"w-full grid grid-cols-1 justify-items-center gap-y-5 py-5 pb-10 px-5 sm:px-10",children:[e.jsx("span",{className:"txt__03",children:"Delete Account"}),e.jsxs("div",{children:[e.jsx("span",{className:"txt__02",children:"This action is "}),e.jsx("span",{className:"txt__03",children:"irreversible "}),e.jsx("span",{className:"txt__02",children:", continuing you will delete your account and all associated data, without possibility of recovery."})]}),e.jsx("div",{className:"w-full flex justify-center mt-14",children:e.jsx(ie,{handleDelete:n,txt:"Delete account"})})]})},ol=({currUser:s,showToastMsg:t,handleErrManageUser:a,setCanManageAccount:n})=>{const{currForm:r,handlePrev:l,handleNext:i,isPrevDisabled:c,isNextDisabled:o,isChildLoading:d,setIsChildLoading:u}=al();return e.jsxs("div",{className:"w-full grid grid-cols-1 justify-items-center gap-y-10 max-w-[600px]",children:[e.jsx("div",{className:`w-full max-w-[600px] justify-self-center grid grid-cols-1 border-[3px] gap-5 border-orange-500 rounded-xl overflow-hidden h-fit  transition-all duration-500 ${r===0?"max-h-[350px]":r===1?"max-h-[750px]":"max-h-[350px]"}`,children:e.jsxs("div",{className:"w-[300%] grid grid-cols-3 transition-all duration-500 place-items-start justify-items-start",style:{transform:`translateX(-${r*100/3}%)`},children:[e.jsx(tl,{currUser:s,showToastMsg:t,setIsChildLoading:u,handleErrManageUser:a}),e.jsx(rl,{currUser:s,showToastMsg:t,setIsChildLoading:u,handleErrManageUser:a,setCanManageAccount:n}),e.jsx(il,{showToastMsg:t,setIsChildLoading:u,handleErrManageUser:a})]})}),e.jsx(Ae,{hiddenLg:!1,currForm:r,totLen:Me,bothDisabled:d,isPrevDisabled:c,isNextDisabled:o,handlePrev:l,handleNext:i})]})},cl=()=>{const{showToastMsg:s,canManageAccount:t,currUser:a,handleErrManageUser:n,setCanManageAccount:r,closeToast:l}=Xr();return e.jsxs("div",{className:"w-full grid grid-cols-1 justify-items-center gap-5 sm:gap-y-10",children:[e.jsx("span",{className:"txt__04",children:"Manage your account"}),t?e.jsx(ol,{currUser:a,showToastMsg:s,handleErrManageUser:n,setCanManageAccount:r}):e.jsx(el,{handleErrManageUser:n,setCanManageAccount:r,closeToast:l})]})},dl=()=>{const[s]=Z(),t=C(),{showToastMsg:a}=R(),{handleErrAPI:n}=I(),r=s.get("token"),l=s.get("userId"),i=le(l??"",W),c=le(r??"",Ce),o=i&&c,{mutate:d}=E({mutationFn:u=>Ua(u),onSuccess:()=>{a("New Email successfully verified!","SUCCESS"),t("/",{replace:!0})},onError:u=>{n({err:u,push:!0})}});return m.useEffect(()=>{o&&d({token:r??"",userId:l??""})},[o,d,r,l]),{canStay:o}},ul=()=>{const{canStay:s}=dl();return s?e.jsx(Y,{}):e.jsx(U,{to:"/",replace:!0})},ml=()=>{const s=C(),{showToastMsg:t}=R(),{handleErrAPI:a}=I(),n=M({mode:"onChange",defaultValues:{}});F(),m.useEffect(()=>{n.setFocus("name")},[n]);const{mutate:r,isPending:l}=E({mutationFn:c=>Qa(c),onSuccess:c=>{t("Restaurant created successfully","SUCCESS"),s(`/my-restaurants/${c==null?void 0:c.restId}`)},onError:c=>{a({err:c})}}),i=n.handleSubmit(c=>{const o=zs(c);r(o)});return{formContext:n,handleSave:i,isPending:l}},X=({field:s,register:t,errors:a,customValidate:n,indexForm:r})=>{var i,c,o,d;const l=r||r===0?(o=(c=(i=a==null?void 0:a.items)==null?void 0:i[r])==null?void 0:c[s.field.split(".").pop()])==null?void 0:o.message:(d=a==null?void 0:a[s.field])==null?void 0:d.message;return e.jsxs("div",{className:"max-w-full w-full grid grid-cols-1 gap-y-3 justify-items-start",children:[e.jsxs("label",{className:"w-full flex flex-col gap-y-2 justify-start",children:[e.jsx("span",{className:"txt__02",children:s.label}),e.jsx("input",{step:(s==null?void 0:s.type)==="number"?"any":void 0,type:(s==null?void 0:s.type)??"text",...t(s.field,{required:s!=null&&s.required?`${s.label} is required`:!1,pattern:{value:s.reg,message:s.msg},validate:u=>n?n(u):!0}),className:"input__base txt__02",placeholder:(s==null?void 0:s.place)??`Your ${s.label}...`})]}),l&&e.jsx("span",{className:"txt__01 text-red-600",children:l})]})},pl=({formContext:s})=>{const{register:t,formState:{errors:a}}=s;return e.jsxs("div",{className:"w-full grid grid-cols-1 gap-y-5",children:[e.jsxs("span",{className:"txt__03 el__sub_title_my_restaurants_form",children:[e.jsx(ws,{className:"w-[35px] h-[35px]"}),"Contact"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-y-5 gap-x-10",children:sr.map(n=>e.jsx(X,{register:t,errors:a,field:n},n.id))})]})},xl=({formContext:s})=>{const{register:t,watch:a,formState:{errors:n},trigger:r}=s,l=a("openTime"),i=a("closeTime");m.useEffect(()=>{(()=>{De(i,l)!==0&&(r("openTime"),r("closeTime"))})()},[l,i,r]);const c=d=>{const u=De(d,a("openTime"));return u>0&&u<4?"You must keep open at least 4 hours (part-time)":!0},o=d=>{const u=De(a("closeTime"),d);return u>0&&u<4?"You must keep open at least 4 hours (part-time)":!0};return e.jsxs("div",{className:"w-full grid grid-cols-1 gap-y-5",children:[e.jsxs("span",{className:"txt__03 el__sub_title_my_restaurants_form",children:[e.jsx(Jt,{className:"w-[35px] h-[35px]"}),"Opening and closing times"]}),e.jsx("div",{className:"w-full sm:grid grid-cols-2 gap-5",children:tr.map(d=>e.jsx(X,{field:d,errors:n,register:t,customValidate:d.field==="closeTime"?c:o},d.id))})]})},gl=()=>{const[s,t]=m.useState(0),a=()=>s>0?t(i=>i-1):void 0,n=()=>s<_e-1?t(i=>i+1):void 0,r=s===0,l=s===_e-1;return{propsBtns:{currForm:s,handlePrev:a,handleNext:n,isPrevDisabled:r,isNextDisabled:l}}},et=({field:s,register:t,valsChosen:a,customValidate:n,currCategory:r})=>{var i;const l=(i=a==null?void 0:a.includes)==null?void 0:i.call(a,s.field);return e.jsxs("label",{className:`w-full flex items-center border-2 rounded-xl py-2 el__flow cursor-pointer ${l?"scale-105 border-orange-500":"border-[#222]"}`,children:[e.jsx("input",{type:"checkbox",value:s.field,...t(r,{validate:c=>n?n(c):!0}),className:"opacity-0 w-0 h-0"}),e.jsx("span",{className:`txt__01 w-full flex justify-center break-all el__flow ${l?"text-orange-500":""}`,children:(s==null?void 0:s.label)??s.field.toUpperCase()})]})},fl=({formContext:s})=>{var i,c;const{register:t,watch:a,formState:{errors:n}}=s,{propsBtns:r}=gl(),l=o=>o!=null&&o.length?(o==null?void 0:o.length)>3?"You can chose up to 3 categories for your restaurant":!0:"You must chose at least one category for your restaurant";return e.jsxs("div",{className:"w-full flex flex-col gap-y-5",children:[e.jsx("div",{className:"w-full p-5 overflow-x-hidden",children:e.jsx("div",{className:"grid lg:max-w-full lg:gap-x-10 lg:grid-cols-2 transition-all duration-500 items-start",style:{width:`${Math.ceil((H==null?void 0:H.length)/6)*100}%`,gridTemplateColumns:`repeat(${_e}, 1fr)`,transform:`translateX(-${r.currForm*(100/Math.ceil((H==null?void 0:H.length)/6))}%)`},children:Ys.map((o,d)=>e.jsx("div",{className:`transition-all lg:opacity-100 duration-300 grid grid-cols-2 gap-x-10 gap-y-5 ${r.currForm!==d?"opacity-0":"opacity-100"}`,children:o.map(u=>e.jsx(et,{register:t,field:u,valsChosen:a("categories"),customValidate:l,currCategory:"categories"},u.id))},d))})}),((i=n==null?void 0:n.categories)==null?void 0:i.message)&&e.jsx("span",{className:"txt__01 -mt-5 text-red-600 pl-5",children:(c=n==null?void 0:n.categories)==null?void 0:c.message}),e.jsx("div",{className:"w-full flex px-5",children:e.jsx(Ae,{totLen:_e,...r,hiddenLg:!0})})]})},hl=({formContext:s})=>e.jsxs("div",{className:"w-full grid grid-cols-1 gap-y-5",children:[e.jsxs("span",{className:"txt__03 el__sub_title_my_restaurants_form",children:[e.jsx(ea,{className:"w-[35px] h-[35px]"}),"Restaurant Category"]}),e.jsx(fl,{formContext:s})]}),yl=({formContext:s})=>{const{register:t,formState:{errors:a}}=s;return e.jsxs("div",{className:"w-full flex flex-col gap-5",children:[e.jsxs("span",{className:"txt__03 el__sub_title_my_restaurants_form",children:[e.jsx(Fs,{className:"h-[35px] w-[35px]"}),"Restaurant name"]}),e.jsx("div",{className:"w-full justify-self-start grid lg:grid-cols-2 gap-y-3 gap-x-10",children:e.jsx(X,{field:Jn,register:t,errors:a})})]})},wl=({indexForm:s,setValue:t,images:a,img:n})=>{const r=s||s===0?`items.${s}.images`:"images";return{handleRemoveExistingFile:()=>{const c=[...a].filter(o=>o!==n);t(r,c,{shouldValidate:!0})},handleRemoveExistingImgUploaded:()=>{const c=a.filter(o=>n instanceof File?!0:o.public_id!==(n==null?void 0:n.public_id));t(r,c,{shouldValidate:!0})}}},st=({img:s,images:t,setValue:a,indexForm:n})=>{const{handleRemoveExistingFile:r,handleRemoveExistingImgUploaded:l}=wl({img:s,images:t,setValue:a,indexForm:n});return e.jsxs("div",{onClick:s instanceof File?r:l,className:"min-w-[150px] max-w-[150px] h-[150px] sm:min-w-[200px] sm:max-w-[200px] sm:h-[200px] rounded-xl snap-center relative group cursor-pointer",children:[s&&e.jsx("img",{className:"w-full h-full",src:s instanceof File?URL.createObjectURL(s):s==null?void 0:s.url,alt:""}),e.jsx("div",{className:"absolute inset-0 bg-black/70 opacity-0 el__flow group-hover:opacity-100"}),e.jsxs("div",{className:"absolute top-1/2 -translate-y-1/2 left-1/2 -translate-x-1/2 w-full flex justify-center items-center z-20 gap-4 el__flow opacity-0 pointer-events-none group-hover:pointer-events-auto group-hover:opacity-100  group-hover:scale-120",children:[e.jsx(ze,{className:"w-[30px] h-[30px] text-red-600"}),e.jsx("span",{className:"txt__01 text-red-600",children:"Remove"})]})]})},tt=({register:s,watch:t,indexForm:a})=>{const n=a||a===0?`items.${a}.images`:"images";return e.jsx("div",{className:"w-full grid ",children:e.jsxs("label",{className:"w-fit grid relative",children:[e.jsx("input",{type:"file",multiple:!0,className:"opacity-0 absolute outline-none",...s(n,{validate:()=>{const r=t(n);return r!=null&&r.length?(r==null?void 0:r.length)>5?"You can upload up to 5 images":!0:"You should upload at least one img"}})}),e.jsxs("button",{type:"button",onClick:r=>{var l,i;(i=(l=r==null?void 0:r.currentTarget)==null?void 0:l.previousElementSibling)==null||i.click()},className:"w-full flex items-center gap-3 group el__flow hover:scale-110 hover:text-orange-500 pl-5 pr-14 py-2 border-[3px] border-orange-500 rounded-xl cursor-pointer justify-self-start outline-none",children:[e.jsx(sa,{className:"h-[35px] w-[35px]"}),e.jsx("span",{className:"txt__02",children:"Upload"})]})]})})},jl=({formContext:s})=>{var c;const{register:t,formState:{errors:a},watch:n,trigger:r,setValue:l}=s,i=n("images");return e.jsxs("div",{className:"w-full flex flex-col gap-5",children:[e.jsxs("span",{className:"txt__03 el__sub_title_my_restaurants_form",children:[e.jsx(Ts,{className:"h-[35px] w-[35px]"}),"Restaurant images"]}),e.jsx("div",{className:`w-full flex flex-row overflow-x-auto snap-x snap-mandatory gap-5 sm:gap-10 hide_scrollbar border-[3px] rounded-xl el__flow ${(c=n("images"))!=null&&c.length?"max-h-[500px] p-5 sm:p-8 border-orange-500 ":"max-h-0 border-transparent"}`,children:!!(i!=null&&i.length)&&[...i].map((o,d)=>e.jsx(st,{img:i[d],trigger:r,images:i,setValue:l},d))}),e.jsx(tt,{register:t,watch:n}),(a==null?void 0:a.images)&&e.jsx("span",{className:"txt__01 text-red-600",children:a.images.message})]})},bl=({formContext:s})=>{const{register:t,formState:{errors:a},watch:n,trigger:r}=s,l=n("price");m.useEffect(()=>{l&&r("freeDeliveryPrice")},[l,r]);const i=o=>{const d=ge(n("closeTime"))-ge(n("openTime"));return d>0&&d<+o?"Delivery time can not take more than your business activity":+o?!0:"Delivery time can not be 0"},c=o=>!+n("price")&&o?"You can not set a free delivery without a delivery charge":!0;return e.jsxs("div",{className:"w-full grid grid-cols-1 gap-y-5",children:[e.jsxs("span",{className:"txt__03 el__sub_title_my_restaurants_form",children:[e.jsx(bs,{className:"w-[40px] h-[40px]"}),"Delivery"]}),e.jsx("div",{className:"w-full grid grid-cols-1 gap-y-5 sm:grid-cols-2 gap-10 lg:grid-cols-3",children:ar.map(o=>e.jsx(X,{register:t,errors:a,field:o,customValidate:o.field==="estTimeDelivery"?i:o.field==="freeDeliveryPrice"?c:void 0},o.id))})]})},_l=({currForm:s,formContext:t})=>{const{register:a,formState:{errors:n}}=t;return e.jsx("div",{className:"overflow-hidden py-5",children:e.jsxs("div",{className:"w-[200%] flex transition-all duration-500 justify-items-start items-start h-fit lg:grid lg:grid-cols-2 lg:w-full lg:gap-10",style:{transform:`translateX(-${s*50}%)`,maxHeight:s===0?"600px":"275px"},children:[e.jsx("div",{className:"w-full flex gap-y-5 flex-col max-h-fit px-2 sm:px-5 lg:p-0",children:Qs.map(r=>e.jsx(X,{register:a,errors:n,field:r},r.id))}),e.jsx("div",{className:"w-full flex gap-y-5 flex-col max-h-fit px-2 sm:px-5 lg:p-0",children:Hs.map(r=>e.jsx(X,{register:a,errors:n,field:r},r.id))})]})})},vl=({watch:s})=>{const[t,a]=m.useState(0),[n,r]=m.useState(!1),i=er[t].map(g=>({val:s(g.field),reg:g.reg}));m.useEffect(()=>{(()=>{r(!1);for(const p of i)p.reg.test(p.val)||r(!0)})()},[t,s,i]);const c=()=>t>0?a(g=>g-1):void 0,o=()=>t<Le-1?a(g=>g+1):void 0,d=t===0,u=n||t===Le-1;return{currForm:t,buttonsProps:{handlePrev:c,handleNext:o,isPrevDisabled:d,isNextDisabled:u}}},Nl=({formContext:s})=>{const{buttonsProps:t,currForm:a}=vl({watch:s.watch});return e.jsxs("div",{className:"w-full grid grid-cols-1 gap-y-5",children:[e.jsxs("span",{className:"txt__03 el__sub_title_my_restaurants_form",children:[e.jsx(ys,{className:"w-[35px] h-[35px]"}),"Restaurant Address"]}),e.jsxs("div",{className:"w-full grid grid-cols-1 border-[3px] rounded-xl border-orange-500 lg:border-0 lg:p-0 p-5 pb-10 gap-y-8",children:[e.jsx(_l,{currForm:a,formContext:s}),e.jsx(Ae,{...t,currForm:a,totLen:Le,hiddenLg:!0})]})]})},at=({formContext:s,handleSave:t,isPending:a})=>{const n=D();return e.jsxs("form",{onSubmit:t,className:"w-full grid grid-cols-1 justify-items-center gap-y-10",children:[e.jsx(yl,{formContext:s}),e.jsx(jl,{formContext:s}),e.jsx(Nl,{formContext:s}),e.jsx(pl,{formContext:s}),e.jsx(xl,{formContext:s}),e.jsx(hl,{formContext:s}),e.jsx(bl,{formContext:s}),e.jsx("div",{className:"max-w-[300px] justify-center mt-10",children:e.jsx(G,{label:`${n.pathname.includes("update")?"Update":"Create"} Restaurant`,type:"submit",styleTxt:"txt__02",isPending:a})})]})},Sl=()=>{const{formContext:s,handleSave:t,isPending:a}=ml();return e.jsx(ue,{...s,children:e.jsxs("div",{className:"w-full grid grid-cols-1 justify-items-center gap-y-5",children:[e.jsx("span",{className:"txt__04",children:"Create new restaurant"}),e.jsx(at,{formContext:s,handleSave:t,isPending:a})]})})},nt=(s,t)=>(m.useEffect(()=>{const a=()=>{const n=window.innerWidth;n>ee.xl?t(12):n>ee.lg?t(9):t(6)};return a(),window.addEventListener("resize",a),()=>{window.removeEventListener("resize",a)}},[s,t]),{limit:s}),Pl=()=>{F();const s=Ne(),[t,a]=m.useState(1),[n,r]=m.useState(6),{handleErrAPI:l}=I();nt(n,r);const{formContextMyRestaurants:i}=he(),c=i.watch();c.page=t+"",c.limit=n+"";const o=i.handleSubmit(x=>{x.page=t+"",sessionStorage.setItem("myRestaurantsForm",JSON.stringify(x)),s.resetQueries({queryKey:["myRestaurants"]})}),d=()=>{sessionStorage.removeItem("myRestaurantsForm"),i.reset(gr),i.trigger("search"),a(1)},{data:u,isPending:g,isSuccess:p,isError:f,error:y}=ae({queryKey:["myRestaurants",c],queryFn:()=>Ha(fn(c))});return m.useEffect(()=>{f&&l({err:y}),p&&(u==null?void 0:u.nHits)<n&&a(1)},[l,f,y,p,u,n]),{isPending:g,formContext:i,currPage:t,setCurrPage:a,handleSave:o,handleClear:d,data:u}},rt=({txt:s,label:t})=>{const a=m.useRef(null),n=m.useRef(null);m.useEffect(()=>{const l=i=>{const c=a.current,o=n.current;c&&o&&c!=null&&c.contains(i.target)&&(o==null||o.classList.remove("generate_password__tooltip"),requestAnimationFrame(()=>o==null?void 0:o.classList.add("generate_password__tooltip")))};return document.addEventListener("click",l),()=>document.removeEventListener("click",l)},[s]);const r=()=>{a.current&&navigator.clipboard.writeText(a.current.innerText)};return e.jsxs("div",{className:"relative group flex items-center max-w-full",children:[e.jsx("button",{type:"button",ref:a,onClick:r,className:"txt__01 el__flow cursor-pointer hover:text-orange-500 outline-none",children:e.jsx("div",{className:"hide_scrollbar overflow-x-auto",children:s})}),e.jsxs("span",{ref:n,className:"absolute lg:text-lg px-4 py-1 -top-1/2 left-1/4 border-2 border-orange-500 rounded-xl w-full whitespace-nowrap bg-[#111] pointer-events-none z-20 txt__00 max-w-fit px-6 min-w-[150px] opacity-0",children:[t," copied ✌🏼"]})]})},lt=({id:s})=>e.jsxs("div",{className:"border-b-2 border-orange-500 w-full grid grid-cols-[75px_1fr]",children:[e.jsxs("div",{className:"w-full flex gap-2 items-center px-3 py-2",children:[e.jsx(ta,{className:"text-orange-500 min-w-[30px] min-h-[30px] -ml-2"}),e.jsx("span",{className:"txt__02 ",children:"ID:"})]}),e.jsx(rt,{txt:s,label:"Id"})]}),it=({images:s,children:t})=>e.jsxs("div",{className:"w-full flex justify-center relative mb-1",children:[t??null,e.jsx("div",{className:"w-full overflow-x-auto hide_scrollbar snap-x snap-mandatory flex gap-4 px-5 mt-16",children:s.map(a=>e.jsx("div",{className:"min-w-[200px] h-[200px] flex justify-center items-center border-2 border-orange-500 overflow-hidden rounded-xl",children:e.jsx("img",{src:a.url,alt:"🧐",className:"w-full h-full object-cover snap-center"})},a.public_id))})]}),ot=({name:s})=>e.jsx("div",{className:"w-full absolute top-0 left-0 flex justify-start h-[50px] bg-black/90 items-center ",children:e.jsx("span",{className:"txt__03 px-3 overflow-x-auto hide_scrollbar",children:s})}),q=({isOpen:s,setIsOpen:t,txt:a,Icon:n,customStyle:r,customIconStyle:l})=>e.jsxs("div",{onClick:()=>t(!s),className:`w-full grid grid-cols-[1fr_75px] items-center group cursor-pointer ${r??""}`,children:[e.jsxs("div",{className:"w-fit flex gap-5 items-center",children:[e.jsx(n,{className:`${l??"min-w-[30px] min-h-[30px]"} group-hover:text-orange-500 el__flow`}),e.jsx("span",{className:"txt__02 group-hover:text-orange-500 el__flow",children:a})]}),e.jsx(aa,{className:`w-[35px] h-[35px] justify-self-end group-hover:text-orange-500 el__flow ${s?"rotate-180":""}`})]}),ct=({el:s,children:t})=>{var r;const[a,n]=m.useState(!1);return e.jsxs("div",{className:"w-full grid grid-cols-1 el__flow relative",children:[e.jsx(q,{isOpen:a,setIsOpen:n,txt:s.label,Icon:s.icon,customStyle:"px-3",customIconStyle:"min-w-[25px] min-h-[25px]"}),e.jsx("ul",{className:`w-[80%] px-3 right-0 max-h-fit grid py-1 border-2 border-orange-500 rounded-xl bg-[#111] transition-all duration-500 absolute ${["Categories","Open Hours"].includes(s.label)?"grid-cols-2":" grid-cols-1 gap-1"} ${a?"opacity-100 -translate-y-full pointer-events-auto":"translate-y-full opacity-0 pointer-events-none"}`,children:t??((r=s==null?void 0:s.vals)==null?void 0:r.map((l,i)=>e.jsx("li",{className:"el__flow hide_scrollbar overflow-x-auto",children:e.jsx("span",{className:"txt__01",children:l})},i)))})]})},we=({el:s,children:t})=>{var l;const[a,n]=m.useState(!1),r=D();return m.useEffect(()=>{const i=()=>/^\/(my-restaurants)\/[a-f0-9]{24}/.test(r.pathname)&&window.innerWidth>ee.sm?n(!0):null;return i(),document.addEventListener("resize",i),()=>document.removeEventListener("resize",i)},[r.pathname]),e.jsxs("div",{className:"w-full grid grid-cols-1 items-start",children:[e.jsx(q,{isOpen:a,setIsOpen:n,txt:s.label,Icon:s.icon,customStyle:"py-1 border-b-2 border-orange-500 px-3"}),e.jsx("ul",{className:`w-full el__flow grid gap-1 gap-2 items-start px-3 ${a?"opacity-100 max-h-[500px] pointer-events-auto pt-2":"opacity-0 max-h-0 pointer-events-none"} ${["Categories","Open Hours"].includes(s.label)?"grid-cols-2":"grid-cols-1"}`,children:t||((l=s==null?void 0:s.vals)!=null&&l.length?s==null?void 0:s.vals.map((i,c)=>e.jsx("li",{className:"el__flow hide_scrollbar overflow-x-auto",children:e.jsx("span",{className:"txt__01",children:i})},c)):null)})]})},dt=({rest:s})=>e.jsxs(e.Fragment,{children:[e.jsxs(we,{el:Cn,children:[En(...s.ordersByStatus).map(t=>e.jsxs("li",{className:"w-full grid grid-cols-[1fr_50px] items-center",children:[e.jsx("span",{className:"txt__01",children:t.label}),e.jsx("span",{className:"txt__02 justify-self-end",children:t.val})]},t.id)),e.jsxs("li",{className:"w-full grid grid-cols-[1fr_50px] items-center",children:[e.jsx("span",{className:"txt__01",children:"Orders count"}),e.jsx("span",{className:"txt__02 justify-self-end",children:s.ordersCount})]})]}),e.jsxs(we,{el:Rn,children:[In(...s.reviewsByRating).map(t=>e.jsxs("li",{className:"w-full grid grid-cols-[1fr_50px] items-center",children:[e.jsx("div",{className:"w-full flex gap-2",children:t.stars.map((a,n)=>e.jsx(a,{},n))}),e.jsx("span",{className:"txt__02 justify-self-end",children:t.val})]},t.id)),Fn(s.avgRating,s.reviewsCount).map(t=>e.jsxs("li",{className:"w-full grid grid-cols-[1fr_50px] items-center",children:[e.jsx("span",{className:"txt__01",children:t.label}),e.jsx("span",{className:"txt__02 justify-self-end",children:t.field})]},t.id))]}),e.jsx(we,{el:An,children:Dn(s.avgPrice,s.avgQuantity,s.dishesCount).map((t,a)=>e.jsxs("li",{className:"w-full grid grid-cols-[1fr_50px] items-center",children:[e.jsx("span",{className:"txt__01",children:t.label}),e.jsx("span",{className:"txt__02 justify-self-end",children:t.field})]},a))})]}),ut=({rest:s,Container:t})=>e.jsxs(e.Fragment,{children:[_n(Object.values(s.address),Object.values(s.contact),s.categories).map((a,n)=>e.jsx(t,{el:a},n)),e.jsx(t,{el:vn,children:Nn(...Object.values(s.openHours)).map((a,n)=>e.jsxs("li",{className:"el__flow overflow-x-auto hide_scrollbar pointer-events-none cursor-pointer flex items-center gap-3",children:[e.jsx(a.icon,{className:"w-[25px] h-[25px]"}),e.jsx("span",{className:"txt__01",children:a.val})]},n))}),e.jsx(t,{el:Sn,children:Pn(...Object.values(s.delivery)).map((a,n)=>a.label==="Free meal"&&!a.val?null:e.jsxs("li",{className:"el__flow overflow-x-auto hide_scrollbar  cursor-pointer grid grid-cols-[150px_1fr]",children:[e.jsx("span",{className:"txt__01",children:a.label}),e.jsx("span",{className:"txt__01 justify-self-end",children:a.label!=="Delivery time"?Xe({price:a.val,showStr:!0}):`${a.val} minutes`})]},n))})]}),El=({rest:s})=>{const[t,a]=m.useState(!1);return e.jsxs("div",{className:"border-[3px] border-orange-500 rounded-xl py-1 pb-5 max-w-[300px] sm:max-w-[350px] justify-self-center",children:[e.jsxs("div",{className:"w-full flex flex-col",children:[e.jsx(lt,{id:s._id}),e.jsx(it,{images:s.images,children:e.jsx(ot,{name:s.name})}),e.jsxs("div",{className:"w-full grid grid-cols-1",children:[e.jsx(q,{isOpen:t,setIsOpen:a,txt:"Details",Icon:He,customStyle:"px-3 border-b-2 border-orange-500 py-1"}),e.jsx("div",{className:`w-full el__flow grid grid-cols-1 gap-3 ${t?"opacity-100 max-h-[500px] pointer-events-auto pt-3":"opacity-0 max-h-0 pointer-events-none"}`,children:e.jsx(ut,{rest:s,Container:ct})}),e.jsx(dt,{rest:s})]})]}),e.jsx("div",{className:"w-full max-w-fit justify-center justify-self-center flex mt-5",children:e.jsx(re,{to:`/my-restaurants/${s._id}`,className:"txt__02 border-2 border-orange-500 rounded-xl px-12 py-1 el__flow hover:text-orange-500 hover:scale-110 cursor-pointer",children:"View Details"})})]})},Cl=({formContext:s})=>{var o,d;const{register:t,formState:{errors:a},watch:n,trigger:r}=s,l=D(),i=l.pathname.includes("my-restaurants")?"restaurant":l.pathname.includes("my-dishes")?"dish":"",c=(o=n("searchVals"))==null?void 0:o[0];return m.useEffect(()=>{var u;(u=a==null?void 0:a.search)!=null&&u.message&&!["id","restaurantId"].includes(c)&&r("search")},[r,c,a]),e.jsxs("div",{className:"w-full flex flex-col gap-3",children:[e.jsxs("label",{className:"w-full grid grid-cols-1 justify-items-start gap-2 relative",children:[e.jsx("input",{type:"text",placeholder:`Search a ${i} ...`,className:"focus__base el__flow outline-none border-2 border-orange-500 rounded-full w-full px-5 pr-14 py-2 txt__01",...t("search",{pattern:{value:Os,message:"Invalid search length or chars 🥸"},validate:u=>["restaurantId","id"].includes(c)&&!W.test(u)?"Invalid Mongo ID":!0})}),e.jsx(na,{className:"absolute top-1/2 -translate-y-1/2 right-[20px] w-[25px] h-[25px] text-orange-500 pointer-events-none"})]}),(a==null?void 0:a.search)&&e.jsx("span",{className:"txt__01 text-red-600",children:(d=a==null?void 0:a.search)==null?void 0:d.message})]})},Rl=({formContext:s,field:t})=>{const[a,n]=m.useState(!1),{register:r,watch:l}=s;return e.jsxs("div",{className:"w-full grid grid-cols-1",children:[e.jsx(q,{isOpen:a,setIsOpen:n,txt:t.label,Icon:t.icon}),e.jsx("div",{className:`w-full grid grid-cols-2 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-5 transition-all duration-300 ${a?"max-h-[700px] opacity-100 pointer-events-auto py-3":"opacity-0 max-h-0 pointer-events-none"}`,children:t.subFields.map(i=>e.jsx(et,{register:r,field:i,valsChosen:l(t.field),currCategory:t.field},i.id))})]})},Il=({register:s,el:t,watch:a,handleChange:n})=>{const r=a("searchVals"),l=Array.isArray(r)?r:[];return e.jsxs("div",{className:"w-full grid grid-cols-[1fr_100px]",children:[e.jsx("span",{className:"txt__01",children:t.label}),e.jsxs("label",{className:"w-[100px] h-[40px] rounded-full check_swap__label justify-self-end relative cursor-pointer",children:[e.jsx("input",{value:t.field,type:"checkbox",className:"opacity-0",...s("searchVals"),onChange:()=>n&&n(t.field)}),e.jsx("span",{className:`absolute w-[40px] h-[40px] top-0 left-0 rounded-full check_swap__swap scale-90 transition-all duration-500 ${l.includes(t.field)?"translate-x-[60px]":"translate-x-0"}`,style:{"--color-swap":l.includes(t.field)?"#16A34A":"#DC2626"}})]})]})},Al=({searchFields:s,formContext:t})=>{const[a,n]=m.useState(!1),{register:r,watch:l,setValue:i,setError:c}=t,o=d=>{(l("searchVals")||[]).includes(d)?i("searchVals",[],{shouldValidate:!0}):i("searchVals",[d],{shouldValidate:!0}),["id","restaurantId"].includes(d)&&!W.test(l("search"))&&c("search",{message:"Invalid Mongo ID"})};return e.jsxs("div",{className:"w-full grid grid-cols-1",children:[e.jsx(q,{isOpen:a,setIsOpen:n,txt:"Text",Icon:ra}),e.jsx("div",{className:`w-full grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-5 transition-all duration-300 ${a?"max-h-[700px] opacity-100 pointer-events-auto py-2":"opacity-0 max-h-0 pointer-events-none"}`,children:!!(s!=null&&s.length)&&s.map(d=>e.jsx(Il,{register:r,el:d,watch:l,handleChange:o},d.id))})]})},Dl=[{field:"name",label:"Name"},{field:"id",label:"Id"},{field:"restaurantName",label:"Restaurant name"},{field:"restaurantId",label:"Restaurant id"}].map(s=>({...s,id:h()})),mt=[{field:"minPrice",label:"Min price",reg:de,msg:"Price must be a number with up to 2 decimal places"},{field:"maxPrice",label:"Max price",reg:de,msg:"Price must be a number with up to 2 decimal places"},{field:"minQuantity",label:"Min quantity",reg:us,msg:"Quantity must be a prime number without decimals"},{field:"maxQuantity",label:"Max quantity",reg:us,msg:"Quantity must be a prime number without decimals"}].map(s=>({...s,id:h(),required:!1,type:"number"})),Fl=ns.map(s=>({field:s,id:h(),label:s==="fast-food"?"Fast-Food":s[0].toUpperCase()+s.slice(1),type:"number"})),pt=[{id:h(),field:"categories",label:"Category",subFields:Fl,icon:Es}],Tl=[{field:"asc",icon:Is},{field:"desc",icon:As}],xt=[{field:"createdAtSort",label:"Created at",icon:Cs},{field:"updatedAtSort",label:"Updated at",icon:Rs},{field:"priceSort",label:"Price",icon:Qe},{field:"quantitySort",label:"Quantity",icon:V}].map(s=>({...s,id:h(),subFields:[...Tl.map(t=>({...t,id:h()}))]}));[...mt.map(s=>s.field),...pt.map(s=>s.field),...xt.map(s=>s.field)];const kl={search:"",searchVals:["name"],categories:[],minPrice:"",maxPrice:"",minQuantity:"",maxQuantity:"",priceSort:[],quantitySort:[],createdAtSort:[],updatedAtSort:[],page:"1"},Ll=({formContext:s})=>{const{register:t,formState:{errors:a},watch:n,trigger:r}=s,[l,i]=m.useState(!1),c=n("minPrice"),o=n("maxPrice");m.useEffect(()=>{(+c<=+o||!o)&&(r("minPrice"),r("maxPrice"))},[r,c,o]);const d=x=>o&&+o<+x?"With max price fewer than min one you will get no results":!0,u=x=>x&&c>+x?"With min price greater than max one you will get no results":!0,g=n("minQuantity"),p=n("maxQuantity");m.useEffect(()=>{(+g<=+p||!p)&&(r("minQuantity"),r("maxQuantity"))},[r,g,p]);const f=x=>p&&+p<+x?"With max quantity fewer than min one you will get no results":!0,y=x=>x&&g>+x?"With min quantity greater than max one you will get no results":!0;return e.jsxs("div",{className:"w-full grid grid-cols-1",children:[e.jsx(q,{isOpen:l,setIsOpen:i,txt:"Stats",Icon:la}),e.jsx("div",{className:`w-full grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-5 transition-all duration-300 ${l?"max-h-[7000px] opacity-100 pointer-events-auto py-2":"opacity-0 max-h-0 pointer-events-none"}`,children:mt.map(x=>e.jsx(X,{field:x,register:t,errors:a,customValidate:x.field==="minPrice"?d:x.field==="maxPrice"?u:x.field==="minQuantity"?f:x.field==="maxQuantity"?y:void 0},x.id))})]})},Ml=({searchFields:s,formContext:t,filters:a})=>{const[n,r]=m.useState(!1),l=D();return e.jsxs("div",{className:"w-full grid grid-cols-1 gap-3 mt-5",children:[e.jsx(q,{txt:"Filter by",Icon:ia,isOpen:n,setIsOpen:r,customStyle:"pb-1 border-b-[3px] border-orange-500"}),e.jsxs("div",{className:`w-full grid grid-cols-1 pb-3 transition-all duration-300 gap-2 ${n?"max-h-[2000px] opacity-100 pointer-events-auto":"opacity-0 max-h-0 pointer-events-none"}`,children:[e.jsx(Al,{formContext:t,searchFields:s}),/^\/(my-dishes).*/.test(l.pathname)&&e.jsx(Ll,{formContext:t}),!!(a!=null&&a.length)&&a.map(i=>e.jsx(Rl,{field:i,formContext:t},i.id))]})]})},Ul=({el:s,currSorter:t,register:a,currVals:n,handleChange:r,customStyle:l})=>e.jsxs("label",{className:`w-full max-w-[65px] py-3 px-8 pr-10 border-2 rounded-xl cursor-pointer group flex justify-center items-center el__flow relative justify-self-center ${(n||[]).includes(s.field)?"border-orange-500 scale-110":"border-[#333] scale-100"} ${l??""}`,children:[e.jsx("input",{value:s.field,type:"checkbox",className:"opacity-0 absolute inset-0 w-full h-full cursor-pointer",...a(`${t}`),onChange:()=>r(s.field)}),e.jsx(s.icon,{className:`min-w-[30px] min-h-[30px] el__flow pointer-events-none ${(n||[]).includes(s.field)?"text-orange-500":""}`})]},s.id),$l=({formContext:s,sorter:t})=>{const{register:a,watch:n,setValue:r}=s,[l,i]=m.useState(!1),c=o=>r(t.field,(n(t.field)||[]).includes(o)?n(t.field).filter(d=>d!==o):[o],{shouldValidate:!0});return e.jsxs("div",{className:"w-full grid grid-cols-1 gap-y-3",children:[e.jsx(q,{isOpen:l,setIsOpen:i,txt:t.label,Icon:t.icon}),e.jsx("div",{className:`w-full grid grid-cols-2 el__flow ${l?"max-h-[700px] opacity-100 pointer-events-auto py-2":"opacity-0 max-h-0 pointer-events-none"}`,children:t.subFields.map((o,d)=>e.jsx(Ul,{el:o,register:a,currSorter:t.field,currVals:n(t.field),handleChange:c,customStyle:""},o.id))})]})},Vl=({formContext:s,sorters:t})=>{const[a,n]=m.useState(!1);return e.jsxs("div",{className:"w-full grid grid-cols-1 gap-3",children:[e.jsx(q,{txt:"Sort by",Icon:oa,isOpen:a,setIsOpen:n,customStyle:"pb-1 border-b-[3px] border-orange-500"}),e.jsx("div",{className:`w-full items-start grid sm:grid-cols-[repeat(auto-fit,minmax(250px,1fr))] transition-all duration-300 gap-4 ${a?"max-h-[2000px] opacity-100 pointer-events-auto":"opacity-0 max-h-0 pointer-events-none"}`,children:!!(t!=null&&t.length)&&t.map(r=>e.jsx($l,{formContext:s,sorter:r},r.id))})]})},gt=({searchFields:s,formContext:t,sorters:a,filters:n,handleSave:r,handleClear:l,isPending:i})=>e.jsxs("form",{className:"w-full max-w-[90%] border-[3px] border-orange-500 rounded-xl p-6",children:[e.jsxs("div",{className:"w-full grid grid-cols-1",children:[e.jsx(Cl,{formContext:t}),e.jsx(Ml,{formContext:t,searchFields:s,filters:n}),e.jsx(Vl,{formContext:t,sorters:a})]}),e.jsxs("div",{className:"w-full grid grid-cols-2 mt-5",children:[e.jsx("div",{className:"sm:w-full justify-self-start w-[30vw] sm:max-w-[200px] sm:justify-self-center",children:e.jsx(te,{type:"submit",label:"Search",styleBtn:"text-green-600",styleTxt:"text-green-600 txt__02",handleClick:r,isPending:i})}),e.jsx("div",{className:"sm:w-full justify-self-end w-[30vw] sm:max-w-[200px] sm:justify-self-center",children:e.jsx(te,{type:"button",label:"Clear",styleBtn:"text-red-600",styleTxt:"text-red-600 txt__02",handleClick:l,isDisabled:i})})]})]}),Ol=({totPages:s})=>{const[t,a]=m.useState(3),[n,r]=m.useState(1),l=m.useRef(null);m.useEffect(()=>{const x=()=>a(window.innerWidth>ee._2xl?12:window.innerWidth>ee.lg?10:window.innerWidth>ee.md?8:window.innerWidth>ee.sm?5:3);return x(),window.addEventListener("resize",x),()=>window.removeEventListener("resize",x)},[]);const i=Math.min(t,s-(n-1)*t),c=n===1,o=n*t>=s,d=Array.from({length:i},(x,w)=>w+1+(n-1)*t),u=()=>o?null:r(n+1),g=()=>c?null:r(n-1),p=()=>{l.current||(l.current=setInterval(()=>{r(x=>x===1?(y(),x):x-1)},150))},f=()=>{l.current||(l.current=setInterval(()=>{r(x=>x*t>=s?(y(),x):x+1)},150))},y=()=>{l.current&&(clearInterval(l.current),l.current=null)};return m.useEffect(()=>()=>y(),[]),{handleNext:u,handlePrev:g,isPrevDisabled:c,isNextDisabled:o,arrToMakeBtns:d,handlePrevInterval:p,handleNextInterval:f,clearIntervalHandler:y,blockSize:t,currBlock:n}},ft=({totPages:s=0,currPage:t,setCurrPage:a})=>{const{handleNext:n,handlePrev:r,arrToMakeBtns:l,isPrevDisabled:i,isNextDisabled:c,handlePrevInterval:o,handleNextInterval:d,clearIntervalHandler:u,blockSize:g,currBlock:p}=Ol({totPages:s});return e.jsx("div",{className:"w-[95%] flex flex-col items-center absolute bottom-10",children:e.jsxs("div",{className:"w-full grid grid-cols-[50px_1fr_50px] items-center",children:[p>1?e.jsx("button",{disabled:i,onClick:r,onMouseDown:o,onMouseUp:u,className:"w-full flex items-center justify-center btn__brand",children:e.jsx(ca,{className:"h-[50px] w-[50px] "})}):e.jsx("div",{className:""}),e.jsx("div",{className:"max-w-full flex items-center justify-around",children:l.map(f=>e.jsx("button",{onClick:()=>a(f),className:`${t===f?"text-orange-500 border-orange-500 scale-120":"text-white"} btn__brand txt__02 border-2 rounded-xl px-4 py-1`,children:f},f))}),p<Math.ceil(s/g)&&e.jsx("button",{disabled:c,onClick:n,onMouseDown:d,onMouseUp:u,className:"w-full flex items-center justify-center btn__brand",children:e.jsx(da,{className:"h-[50px] w-[50px] "})})]})})},ht=({nHits:s,totDocuments:t,isPending:a})=>{const n=D().pathname,r=n.includes("/my-dishes")?"dishes":n.includes("/my-restaurants")?"restaurants":"";return a?null:e.jsx("div",{className:"w-full grid grid-cols-1",children:t?s?e.jsxs("div",{className:"w-full flex gap-5 items-center mt-[25px]",children:[e.jsx(ua,{className:"min-w-[35px] min-h-[35px]"}),e.jsxs("div",{className:"w-fit flex gap-2 items-center",children:[e.jsxs("span",{className:"txt__04",children:[s," "]}),e.jsxs("span",{className:"txt__03",children:["Result",s>1?"s":""]})]})]}):e.jsx("div",{className:"w-full flex justify-self-center justify-center items-center mt-[50px]",children:e.jsx("span",{className:"txt__03",children:"Number results = Number(new String()) 🥸"})}):e.jsx("div",{className:"w-full flex justify-self-center justify-center mt-[50px]",children:e.jsxs("span",{className:"txt__03",children:["You have Number(Array().fill()+Array().fill()) ",r," 🥸"]})})})},Bl=()=>{const{isPending:s,formContext:t,currPage:a,setCurrPage:n,handleSave:r,handleClear:l,data:i}=Pl(),{restaurants:c,totDocuments:o=0,totPages:d=0,nHits:u=0}=i??{};return e.jsxs("div",{className:"w-full grid grid-cols-1 justify-items-center gap-5",children:[e.jsx("span",{className:"txt__04",children:"My Restaurants"}),e.jsx(ue,{...t,children:e.jsx(gt,{searchFields:rr,sorters:xr,filters:Zs,formContext:t,handleSave:r,handleClear:l,isPending:s})}),e.jsx(ht,{isPending:s,nHits:u,totDocuments:o}),s?e.jsx(Y,{}):e.jsx("div",{className:"w-full grid grid-cols-1 sm:grid-cols-[repeat(auto-fit,minmax(350px,1fr))] justify-items-center gap-10 mt-5 items-start",children:c==null?void 0:c.map(g=>e.jsx(El,{rest:g},g._id))}),e.jsx(ft,{currPage:a,setCurrPage:n,totPages:d})]})},yt=()=>{var u;const{popup:s,setPopup:t}=pe(),{handleErrAPI:a}=I(),{showToastMsg:n}=R(),r=(u=Se())==null?void 0:u.restId,l=C(),{mutate:i,isPending:c}=E({mutationFn:()=>(t({...s,isPending:!0}),Wa(r??"")),onSuccess:()=>{n("Restaurant deleted","SUCCESS"),l("/my-restaurants",{replace:!0})},onError:g=>{a({err:g})},onSettled:()=>t(null)}),o=()=>{i()};return{handleClickToOpenPopup:()=>{t({txt:"delete this restaurant?",redLabel:"Delete restaurant",isPending:c,confirmAction:o})}}},ql=()=>{const{restId:s}=Se(),t=C(),a=W.test(s??"");F();const{handleErrAPI:n}=I(),{showToastMsg:r}=R(),l=M({mode:"onChange"});m.useEffect(()=>{l.setFocus("name")},[l]);const{data:i,isPending:c,isSuccess:o,isError:d,error:u}=ae({queryFn:()=>Ya(s??""),queryKey:["infoMyRestaurant"],enabled:a});m.useEffect(()=>{if(d)n({err:u,push:!0});else if(o){const{restaurant:x}=i??{};l.setValue("name",(x==null?void 0:x.name)??""),l.setValue("images",(x==null?void 0:x.images)??[]),l.setValue("categories",(x==null?void 0:x.categories)??[]);for(const w in x==null?void 0:x.address)l.setValue(`${w}`,x==null?void 0:x.address[w]);for(const w in x==null?void 0:x.contact)l.setValue(`${w}`,x==null?void 0:x.contact[w]);for(const w in x==null?void 0:x.delivery)l.setValue(`${w}`,x==null?void 0:x.delivery[w]);for(const w in x==null?void 0:x.openHours)l.setValue(`${w}`,ke(x==null?void 0:x.openHours[w]))}},[u,d,n,o,i,l]);const{mutate:g,isPending:p}=E({mutationFn:({id:x,formData:w})=>Za({id:x,formData:w}),onSuccess:x=>{r("Restaurant updated","SUCCESS"),t(`/my-restaurants/${x==null?void 0:x.restId}`)},onError:x=>{n({err:x})}}),f=l.handleSubmit(x=>{const w=zs(x);g({id:s??"",formData:w})}),{handleClickToOpenPopup:y}=yt();return{formContext:l,canStay:a,isPendingInfo:c,handleSave:f,isPendingUpdate:p,handleClickToOpenPopup:y}},zl=()=>{const{formContext:s,canStay:t,isPendingInfo:a,handleSave:n,isPendingUpdate:r,handleClickToOpenPopup:l}=ql();return t?a?e.jsx(Y,{}):e.jsx(ue,{...s,children:e.jsxs("div",{className:"w-full grid grid-cols-1 justify-items-center gap-y-5",children:[e.jsx("span",{className:"txt__04",children:"Update your restaurant"}),e.jsx("div",{className:"w-full flex justify-end",children:e.jsx(ie,{txt:"Delete restaurant",handleDelete:l})}),e.jsx(at,{formContext:s,handleSave:n,isPending:r})]})}):e.jsx(U,{to:"/",replace:!0})},Gl=()=>{const{setCurrUser:s,isLogged:t,setUserLogged:a,logoutUser:n}=$(),{handleErrAPI:r}=I(),l=m.useRef(0),{mutate:i}=E({mutationFn:rn,onSuccess:g=>{a(g==null?void 0:g.accessToken)},onError:()=>{t&&n()}});m.useEffect(()=>{!t&&(l==null?void 0:l.current)<3&&(l.current+=1,i())},[t,i]);const{data:c,isSuccess:o,isError:d,error:u}=ae({queryKey:["currUser",t],queryFn:Fa,enabled:t});m.useEffect(()=>{(()=>{if(d)r({err:u});else if(o){const{user:p={}}=c??{};s({user:p})}})()},[d,o,r,u,s,c,n,t])},Ql=()=>{const[s,t]=m.useState(!1),a=m.useRef(null),n=m.useRef(null),r=C();return m.useEffect(()=>{const d=u=>{a.current&&!a.current.contains(u.target)&&t(!1)};return document.addEventListener("mousedown",d),()=>{document.removeEventListener("mousedown",d)}},[]),{toggleDrop:()=>t(d=>!d),dropOpen:s,dropRef:a,handleSideClick:(d,u)=>{r(d,u?{state:{from:u}}:void 0),t(!1)},handleMouseEnter:()=>{n.current&&clearTimeout(n.current),t(!0)},handleMouseLeave:()=>{n.current=setTimeout(()=>{t(!1)},250)}}},wt=({isLogged:s,children:t})=>{const a=D(),[n]=Z(),r=n.get("type"),{toggleDrop:l,dropOpen:i,dropRef:c,handleSideClick:o,handleMouseEnter:d,handleMouseLeave:u}=Ql(),g=s?yr:Xs;return e.jsxs("div",{ref:c,className:"flex items-center justify-center cursor-pointer relative",children:[e.jsx("div",{onMouseEnter:d,onMouseLeave:u,onClick:l,className:`txt__01 ${s?"el__flow hover:text-orange-500 hover:scale-120 border-2 py-1 px-2 rounded-xl":""}`,children:s?sessionStorage.getItem("initName")??"":e.jsx(Ds,{className:"w-[37.5px] h-[37.5px] el__flow hover:text-orange-500 hover:scale-120"})}),e.jsx("div",{onMouseEnter:d,onMouseLeave:u,className:`absolute border-2 border-orange-500 bg-[#111] -top-full -right-full h-fit w-fit rounded-xl z-10 el__flow  ${i?"translate-y-[40%] opacity-100":"opacity-0 translate-y-0 pointer-events-none"}`,children:e.jsxs("div",{className:"w-full flex flex-col items-start",children:[g.map(p=>e.jsxs("button",{onClick:()=>o(p.path,(p==null?void 0:p.from)??""),className:`min-w-[300px] w-full flex gap-3 border-b-orange-500 border-b-2 pl-3 pr-10 py-3 justify-start group cursor-pointer hover:text-orange-500 ${Gs({location:a,el:p,type:r})?"text-orange-500":""}`,children:[e.jsx(p.svg,{className:"svg__drop"}),e.jsx("span",{className:"txt__02 el__flow",children:p.label})]},p.id)),t??null]})})]})},jt=()=>{const{showToastMsg:s}=R(),{logoutUser:t}=$(),a=C(),{mutate:n,isPending:r}=E({mutationFn:()=>en(),onSuccess:()=>{s("Logout successful","SUCCESS")},onError:l=>{var i,c;s(((c=(i=l==null?void 0:l.response)==null?void 0:i.data)==null?void 0:c.msg)||(l==null?void 0:l.message),"ERROR")},onSettled:()=>{t(),a("/",{replace:!0})}});return{isPending:r,mutate:n}},Hl=()=>{const{mutate:s,isPending:t}=jt(),a=()=>{s()};return e.jsx(wt,{isLogged:!0,children:t?e.jsx("div",{className:"h-[50px] w-full flex items-center justify-start pl-5",children:e.jsx(Pe,{})}):e.jsxs("button",{onClick:a,className:"w-full cursor-pointer flex gap-3 pl-3 pr-10 py-3 justify-start group",children:[e.jsx(ks,{className:"svg__drop"}),e.jsx("span",{className:"txt__02 group-hover:text-orange-500 duration-300 transition-all",children:"Logout"})]})})},Yl=()=>e.jsx(wt,{isLogged:!1}),Zl=({setSideOpen:s,sideOpen:t})=>{const{isLogged:a}=$(),r=D().pathname!=="/notice-email-sent";return e.jsx("div",{className:"sticky top-0 left-0 h-[75px] w-full border-b-3 border-orange-500 bg-[#111] pad__page flex items-center header__i",children:e.jsxs("div",{className:"w-full grid grid-cols-2",children:[e.jsx(re,{className:"txt__05 text-orange-500 max-w-fit",to:"/",children:"MERN__EAT"}),r&&e.jsxs("div",{className:"flex w-full gap-5 items-center justify-end",children:[a?e.jsx(Hl,{}):e.jsx(Yl,{}),t?e.jsx("div",{onClick:()=>s==null?void 0:s(!1),className:"max-w-fit justify-self-end group flex items-center",children:e.jsx(We,{className:"svg__header"})}):e.jsx("div",{onClick:()=>s==null?void 0:s(!0),className:"max-w-fit justify-self-end group flex items-center",children:e.jsx(ma,{className:"svg__header"})})]})]})})},Wl=()=>{const{setPopup:s,popup:t}=pe(),{txt:a,greenLabel:n="I change idea",redLabel:r,confirmAction:l,isPending:i}=t??{};return e.jsx("div",{className:`${t?"fixed":"hidden"} top-0 left-0 w-full h-full bg-black/50 popup__i flex justify-center items-center`,children:e.jsxs("div",{className:"w-[75vw] max-w-[750px] h-1/2 bg-[#111] border-[3px] border-orange-500 rounded-2xl grid grid-cols-1 p-5 content-start relative",children:[e.jsx("div",{onClick:()=>s(null),className:"w-fit h-fit justify-self-end flex justify-end -mt-3 -mr-2",children:e.jsx(We,{className:"w-[35px] h-[35px] sm:h-[40px] sm:w-[40px] text-red-600 btn__pseudo hover:scale-120"})}),e.jsx("div",{className:"w-full h-fit flex justify-center self-start mt-[5%]",children:e.jsxs("span",{className:"txt__03",children:["Are you sure you want to ",a]})}),e.jsxs("div",{className:"w-full h-fit grid grid-cols-1 sm:grid-cols-2 absolute bottom-[20%] left-1/2 -translate-x-1/2 justify-items-center gap-5",children:[e.jsx("div",{className:"w-full max-w-[250px] flex justify-center",children:e.jsx(te,{label:n??"I change idea",styleTxt:"txt__02 text-green-600",styleBtn:"border-green-600",handleClick:()=>s(null),isDisabled:i})}),e.jsx("div",{className:"w-full max-w-[250px] flex justify-center",children:e.jsx(te,{label:r,styleTxt:"txt__02 text-red-600",styleBtn:"border-red-600",handleClick:l,isPending:i})})]})]})})},Kl=()=>{const s=m.useRef(null),[t,a]=m.useState(!1),n=m.useRef(null),{isToast:r,msg:l,type:i,closeToast:c}=R();return m.useEffect(()=>{let o;return r&&(a(!1),o=setTimeout(()=>{c()},5e3),s.current=o),()=>{clearTimeout(o),r&&a(!0),s.current&&(s.current=null)}},[c,r]),m.useEffect(()=>{r&&n.current&&(n.current.classList.remove("toast__container_after"),requestAnimationFrame(()=>{var o;return(o=n.current)==null?void 0:o.classList.add("toast__container_after")}))},[r,c]),{isToast:r,toastRef:n,msg:l,type:i,closeToast:c,closeClicked:t,setCloseClicked:a}},Xl=()=>{const{isToast:s,msg:t,type:a,closeToast:n,closeClicked:r,setCloseClicked:l,toastRef:i}=Kl();return e.jsx("div",{id:"toast",className:`top-5 right-5 fixed toast__i bg-[#111] rounded-xl text-[whitesmoke] min-w-3/4 sm:min-w-1/2 max-w-3/4 h-fit min-h-[75px] flex border-t-2 border-r-2 el__flow  ${a==="SUCCESS"?"border-green-600":"border-red-600"} 
      ${s?"toast__active_in":!s&&r?"toast__active_out":"translate-x-[120%] opacity-0"}
      `,children:e.jsxs("div",{ref:i,className:`w-full grid grid-cols-[75px_1fr] relative min-h-full rounded-xl border-l-[8px]  ${a==="SUCCESS"?"border-green-600":"border-red-600"}`,style:{"--toast-color":a==="SUCCESS"?"#16a34a":"#dc2626"},children:[e.jsx("div",{className:"w-full flex flex-col items-center justify-center",children:a==="SUCCESS"?e.jsx(pa,{className:"h-[30px] w-[30px] sm:h-[35px] sm:w-[35px] text-green-600"}):e.jsx(Ze,{className:"h-[30px] w-[30px] sm:h-[35px] sm:w-[35px] text-red-600"})}),e.jsx("div",{className:`absolute txt__03 top-3 left-[75px] ${a==="SUCCESS"?"text-green-600":"text-red-600"}`,children:a}),e.jsx("div",{onClick:()=>{l(!0),n()},className:"absolute right-5 top-3 ",children:e.jsx(We,{className:"h-[30px] w-[30px] sm:w-[32px] sm:h-[32px] text-red-600 hover:scale-120 btn__pseudo"})}),e.jsx("div",{className:"w-full flex justify-start pr-6 pb-6 pt-12",children:e.jsx("span",{className:"txt__03",children:t})})]})})},Jl=()=>{const{isLogged:s,currUser:t,setCurrUser:a}=$(),{showToastMsg:n}=R(),{handleErrAPI:r}=I(),l=C(),{register:i,formState:{errors:c},handleSubmit:o,reset:d}=M({mode:"onChange"}),{mutate:u,isPending:g}=E({mutationFn:j=>Ba(j),onSuccess:()=>{d(),n("You have successfully subscribed to out newsLetter","SUCCESS")},onError:j=>{var _,S;n(((S=(_=j==null?void 0:j.response)==null?void 0:_.data)==null?void 0:S.msg)||j.message,"ERROR")}}),p=o(j=>{u(j.email)}),{mutate:f,isPending:y}=E({mutationFn:({type:j})=>Oa({type:j}),onSuccess:j=>{var _;a({user:j==null?void 0:j.user}),n(`You have ${(_=j==null?void 0:j.user)!=null&&_.hasSubscribedToNewsletter?"subscribed":"unsubscribed"} to our newsletter successfully`,"SUCCESS")},onError:j=>{var _,S,T;((_=j==null?void 0:j.response)==null?void 0:_.status)===401?r({err:j}):n(((T=(S=j==null?void 0:j.response)==null?void 0:S.data)==null?void 0:T.msg)||j.message,"ERROR")}});return{isLogged:s,toggleNewsLetter:()=>{f({type:t!=null&&t.hasSubscribedToNewsletter?"unsubscribe":"subscribe"})},isPendingLogged:y,register:i,errors:c,currUser:t,submitSubscribeNonLoggedUser:p,isPendingNonLogged:g,handleRedirection:()=>l("/newsletter/notice-unsubscribe-with-retry?success=false",{state:{from:"/newsletter/verify-unsubscribe"}})}},ei=({isPending:s,currUser:t,submitNewsLetter:a})=>e.jsx("div",{className:"max-w-[200px] md:max-w-[225px] flex justify-start",children:e.jsx(G,{label:t!=null&&t.hasSubscribedToNewsletter?"Unsubscribe":"Subscribe",type:"button",handleClick:a,isPending:s})}),si=({isPending:s,currUser:t,submitNewsLetter:a,register:n,errors:r})=>{var l,i;return e.jsx("div",{className:"w-full flex flex-col gap-5",children:e.jsxs("form",{className:"grid grid-cols-[repeat(auto-fit,minmax(225px,1fr))] sm:grid-cols-2 gap-5 sm:gap-x-10 items-center",children:[e.jsxs("div",{className:"w-full flex flex-col gap-3",children:[e.jsx("input",{type:"email",className:"input__base txt__01",placeholder:"Your email...",...n("email",{required:"Email is required",pattern:{value:Ke,message:"Enter a valid email to receive great discounts "}})}),((l=r==null?void 0:r.email)==null?void 0:l.message)&&e.jsx("span",{className:"txt__00 text-red-600",children:(i=r==null?void 0:r.email)==null?void 0:i.message})]}),e.jsx("div",{className:"w-full max-w-[200px] md:max-w-[225px] flex justify-start items-start",children:e.jsx(G,{label:t!=null&&t.hasSubscribedToNewsletter?"Unsubscribe":"Subscribe",type:"submit",handleClick:a,isPending:s})})]})})},ti=()=>{const{isLogged:s,toggleNewsLetter:t,isPendingLogged:a,register:n,errors:r,currUser:l,submitSubscribeNonLoggedUser:i,isPendingNonLogged:c,handleRedirection:o}=Jl();return e.jsxs("div",{className:"flex w-full flex-col items-start gap-5",children:[e.jsxs("div",{className:`w-full grid items-center gap-4  ${s?"grid-cols-[repeat(auto-fit,minmax(200px,1fr))] sm:grid-cols-2":" grid-cols-1 lg:grid-cols-[200px_1fr]"}`,children:[e.jsx("div",{className:"w-full flex flex-col self-start",children:e.jsx("span",{className:"txt__02",children:"Newsletter"})}),s?e.jsx(ei,{currUser:l,submitNewsLetter:t,isPending:a}):e.jsx(si,{register:n,errors:r,submitNewsLetter:i,currUser:l,isPending:c})]}),!s&&e.jsx("div",{className:"w-full flex justify-start",children:e.jsx("span",{onClick:o,className:"txt__01 el__after_below cursor-pointer el__flow hover:text-orange-500",children:"Send link to unsubscribe"})}),e.jsx("div",{className:"w-full flex",children:e.jsx("span",{className:"txt__00",children:"Subscribe to our newsletter to receive the latest updates and get a chance to win a discount coupon."})})]})},ai=()=>e.jsxs("div",{className:"pad__page py-5 border-t-2 border-orange-500 w-full flex flex-col items-center gap-y-5",children:[e.jsxs("div",{className:"grid w-full gap-y-5 ",children:[e.jsx(re,{to:"/",className:"txt__05 text-orange-500",children:"LOGO"}),e.jsx("div",{className:"w-full grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-4",children:Yn.map(s=>e.jsx("div",{className:"w-full flex flex-col items-start",children:e.jsx(re,{to:s.path,className:"el__after_below txt__02 el__flow hover:text-orange-500 opacity-50",children:s.label})},s.id))})]}),e.jsx("ul",{className:"w-full grid grid-cols-[repeat(auto-fit,minmax(200px,1fr))] lg:grid-cols-[200px_1fr] justify-items-start gap-y-5",children:Zn.map(s=>e.jsx("li",{children:e.jsxs("a",{href:s.url,className:"grid max-w-fit grid-cols-[40px_1fr] items-end el__flow el__after_below hover:text-orange-500",children:[e.jsx(s.svg,{className:"w-[30px] h-[30px] "}),e.jsx("span",{className:"txt__01",children:s.label})]})},s.id))}),e.jsx(ti,{}),e.jsx("div",{className:"w-full flex justify-center py-5",children:e.jsxs("span",{className:"txt__01",children:["© ",new Date().getFullYear()," MERN__EAT. No rights reserved just making it for fun ✌🏼"]})})]}),ni=({currUser:s})=>e.jsx("div",{className:"w-full flex items-center border-b-2 border-orange-500 sticky pt-4 top-0 z-20 bg-[#111]",children:e.jsxs("div",{className:"w-full flex items-center pb-4 pl-3 gap-3",children:[e.jsx(xa,{className:" w-[35px] h-[35px] sm:w-[40px] sm:h-[40px]"}),e.jsx("span",{className:"txt__02 max-w-full truncate",children:s.email})]})}),je=({handleSideClick:s,type:t,location:a,el:n,customStyle:r})=>e.jsxs("button",{onClick:()=>s(n.path,n==null?void 0:n.from),className:`w-full cursor-pointer flex gap-3 group max-w-fit items-center el__after_below sideLink ${r??""} ${Gs({location:a,el:n,type:t})}`,children:[e.jsx(n.svg,{className:"svg__sidebar"}),e.jsx("span",{className:"cursor-pointer txt__02 group-hover:text-orange-500 el__flow",children:n.label})]},n.id),ri=({handleLogout:s,isPending:t})=>t?e.jsx("div",{className:"mt-[10px]",children:e.jsx(Pe,{})}):e.jsxs("button",{onClick:s,className:"w-full flex gap-3 group max-w-fit items-center el__after_below",children:[e.jsx(ks,{className:"svg__sidebar"}),e.jsx("span",{className:"cursor-pointer txt__02 group-hover:text-orange-500 el__flow",children:"Logout"})]}),li=({handleSideClick:s})=>{const[t,a]=m.useState(!1),n=D(),[r]=Z(),l=r.get("type");return e.jsxs("div",{className:"w-full grid grid-cols-1",children:[e.jsx(q,{txt:xs.label,Icon:xs.icon,isOpen:t,setIsOpen:a,customIconStyle:"min-w-[40px] min-h-[40px]"}),e.jsx("div",{className:`w-full grid grid-cols-1 el__flow gap-6 pl-5 ${t?"max-h-[500px] opacity-100 pointer-events-auto pt-3":"max-h-0 opacity-0 pointer-events-none"}`,children:hr.map((i,c)=>e.jsx(je,{el:i,location:n,type:l,handleSideClick:s,customStyle:c?void 0:"pt-2"},i.id))})]})},ii=({sideOpen:s,setSideOpen:t})=>{const a=m.useRef(null),n=D(),r=C(),[l]=Z(),i=l.get("type"),{isLogged:c,currUser:o}=$();m.useEffect(()=>{const f=y=>{var x;(x=a.current)!=null&&x.contains(y.target)||t(!1)};return document.addEventListener("mousedown",f),()=>{document.removeEventListener("mousedown",f)}},[t,a]);const{mutate:d,isPending:u}=jt(),g=()=>d(),p=(f,y)=>{r(f,y?{state:{from:y}}:void 0),t(!1)};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`${s?"fixed":"hidden"} inset-0 bg-black/50 sidebar__i_bg transition-none`}),e.jsx("div",{ref:a,className:`${s?"translate-x-0 overflow-y-auto hide_scrollbar pb-[50px]":"translate-x-full"} sidebar__content sidebar__i_content`,children:e.jsxs("div",{className:"w-full grid grid-cols-1 justify-items-start gap-5 px-3",children:[o&&e.jsx(ni,{currUser:o}),fr.map(f=>e.jsx(je,{handleSideClick:p,type:i,location:n,el:f},f.id)),c?e.jsxs(e.Fragment,{children:[Ks.map(f=>e.jsx(je,{handleSideClick:p,type:i,location:n,el:f},f.id)),e.jsx(li,{handleSideClick:p})]}):Xs.map(f=>e.jsx(je,{handleSideClick:p,type:i,location:n,el:f},f.id)),c&&e.jsx(ri,{isPending:u,handleLogout:g})]})})]})},oi=({images:s})=>{const[t,a]=m.useState(0),[n,r]=m.useState(!1),l=m.useCallback(()=>{t===s.length-1?a(0):a(c=>c+1)},[t,s.length]),i=()=>{a(t===0?s.length-1:c=>c-1)};return m.useEffect(()=>{if(n)return;const c=setInterval(()=>{l()},1500);return()=>clearInterval(c)},[n,l]),{activeIndx:t,handleNext:l,handlePrev:i,setBtnClicked:r}},bt=({images:s})=>{const{activeIndx:t,handleNext:a,handlePrev:n,setBtnClicked:r}=oi({images:s});return e.jsx("div",{className:"pad__page w-full pt-5 flex flex-col justify-center",children:e.jsxs("div",{className:"w-full flex items-center relative",children:[e.jsx("button",{onClick:()=>{r(!0),n()},className:"absolute top-1/2 left-0 -translate-y-1/2 hero__i_arrow outline-none",children:e.jsx(ga,{className:"h-[50px] w-[50px] text-orange-500 btn__pseudo hover:scale-120"})}),e.jsx("div",{className:"flex w-full overflow-hidden border-2 border-orange-500 p-6 rounded-xl gap-[10%]",children:s.map(l=>e.jsx("div",{className:"min-w-[200px] h-[200px] sm:min-w-[350px] sm:h-[350px] rounded-xl transition-all duration-500 overflow-hidden",style:{transform:`translateX(-${t*100}%`},children:e.jsx("img",{src:(l==null?void 0:l.url)??l.img,alt:"burger_hero",className:"min-w-full object-cover h-full "})},(l==null?void 0:l.public_id)??l.id))}),e.jsx("button",{onClick:()=>{r(!0),a()},className:"absolute top-1/2 right-0 -translate-y-1/2 hero__i_arrow outline-none",children:e.jsx(fa,{className:"h-[50px] w-[50px] text-orange-500 btn__pseudo hover:scale-120"})})]})})},ci=()=>e.jsx(bt,{images:Hn}),di=({children:s})=>{const[t,a]=m.useState(!1),n=D();return e.jsxs("div",{className:"w-full min-h-screen flex flex-col items-center",children:[e.jsx(Zl,{setSideOpen:a,sideOpen:t}),e.jsx(ii,{sideOpen:t,setSideOpen:a}),e.jsx(Wl,{}),e.jsx(Xl,{}),n.pathname==="/"&&e.jsx(ci,{}),e.jsx("div",{className:"flex flex-col items-center w-full pad__page py-5 pb-[150px] sm:pb-[200px] lg:pb-[300px] relative",children:s}),e.jsx(ai,{})]})},ui=()=>e.jsx(di,{children:e.jsx(me,{})}),mi=()=>{const{isLogged:s}=$();return s?e.jsx(U,{to:"/",replace:!0}):e.jsx(me,{})},pi=()=>{const{isLogged:s}=$();return s?e.jsx(me,{}):e.jsx(U,{to:"/",replace:!0})},xi=()=>e.jsx(me,{}),gi=()=>{const{isLogged:s}=$();return s?e.jsx(me,{}):e.jsx(U,{to:"/",replace:!0})},fi=()=>{F();const{handleErrAPI:s}=I(),{restId:t}=Se(),a=W.test(t??""),{data:n,isPending:r,isError:l,error:i}=ae({queryKey:["mySingleRestaurant",t],queryFn:()=>Ka(t??""),enabled:a}),c=m.useCallback(()=>{l&&s({err:i})},[l,s,i]);m.useEffect(()=>{c()},[c]);const{restaurant:o,success:d}=n??{};return{canStay:a,isPending:r,restaurant:o,success:d,restId:t}},cs=({txt:s})=>e.jsx("div",{className:"w-full flex flex-col h-[30vh] justify-center items-center",children:e.jsx("span",{className:"txt__03",children:s})}),hi=({restId:s})=>{const[t,a]=m.useState(!1),{formContextMyDishesAddItem:n,formContextMyDishesSearch:r}=he(),l=()=>{const{setValue:o}=r;o("searchVals",["restaurantId"]),o("search",s??"")},i=()=>n.setValue("restaurant",s??""),{handleClickToOpenPopup:c}=yt();return e.jsxs("div",{className:"w-full grid grid-cols-1 relative my_restaurant_drop__i",children:[e.jsx("div",{className:"h-[50px]"}),e.jsxs("div",{className:"border-2 border-orange-500 rounded-xl w-fit justify-self-end py-2 px-3 absolute z-10 bg-[#111]",children:[e.jsx("div",{className:"w-full ",children:e.jsx(q,{isOpen:t,setIsOpen:a,txt:"Business",Icon:Ye})}),e.jsx("ul",{className:`w-full grid grid-cols-1 el__flow pl-1 gap-6 ${t?"opacity-100 pointer-events-auto max-h-[500px] pb-4":"opacity-0 pointer-events-none max-h-0"}`,children:bn(s??"").map(o=>e.jsx("li",{onClick:()=>o.label==="Add dish"?i():o.label==="My dishes"?l():o.label==="Delete"?c():null,className:"w-full flex items-center gap-3 group el__flow cursor-pointer first:pt-4 hover:text-orange-500 el__after_below",children:o.label==="Delete"?e.jsxs("div",{className:"w-full flex items-center gap-3",children:[e.jsx(o.icon,{className:"min-w-[25px] min-h-[25px] group-hover:text-orange-500 el__flow"}),e.jsx("span",{className:"txt__02 group-hover:text-orange-500 el__flow ",children:o.label})]}):e.jsxs(re,{to:o.path,className:"w-full flex items-center gap-3",children:[e.jsx(o.icon,{className:"min-w-[25px] min-h-[25px] group-hover:text-orange-500 el__flow"}),e.jsx("span",{className:"txt__02 group-hover:text-orange-500 el__flow ",children:o.label})]})},o.id))})]})]})},yi=()=>{const{canStay:s,isPending:t,restaurant:a,restId:n}=fi();return s?t?e.jsx(Y,{}):Object.keys(a??{}).length?e.jsxs("div",{className:"w-full grid grid-cols-1 justify-items-center gap-5",children:[e.jsx("span",{className:"txt__04 truncate max-w-full",children:a.name}),e.jsx(hi,{restId:n}),e.jsx(bt,{images:a.images}),e.jsxs("div",{className:"w-full grid sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-y-3 gap-x-6 items-start",children:[e.jsx(ut,{rest:a,Container:we}),e.jsx(dt,{rest:a})]})]}):e.jsx(cs,{txt:"It seems we did not find any restaurant 🧐"}):e.jsx(U,{to:"/",replace:!0})},wi=()=>{const{isLogged:s}=$();return s?e.jsx(me,{}):e.jsx(U,{to:"/",replace:!0})},ji=async()=>{const{data:s}=await b.get("/my-dishes/restaurant-ids");return s},bi=async({restId:s,form:t})=>{const{data:a}=await b.post(`/my-dishes?restId=${s}`,t);return a},_i=async s=>{const{data:t}=await b.get(`/my-dishes?${s}`);return t},vi=async s=>{const{data:t}=await b.get(`/my-dishes/info-dish/${s}`);return t},Ni=async s=>{const{data:t}=await b.delete(`/my-dishes/${s}`);return t},Si=async({formData:s,id:t})=>{const{data:a}=await b.put(`/my-dishes/${t}`,s);return a},Pi=async s=>{const{data:t}=await b.delete("/my-dishes/bulk-delete",{data:{ids:s}});return t},Ei=async s=>{const{data:t}=await b.delete(`/my-dishes/bulk-delete-query?${s}`);return t},_t=()=>{const{handleErrAPI:s}=I(),{data:t,isPending:a,isSuccess:n,isError:r,error:l}=ae({queryKey:["restaurantIds"],queryFn:ji}),i=m.useCallback(()=>{r&&s({err:l})},[r,l,s]);return m.useEffect(()=>{i()},[i]),{isPendingIds:a,restInfo:t==null?void 0:t.infoRestaurants,isSuccessIds:n}},Ci=()=>{F();const{handleErrAPI:s}=I(),{formContextMyDishesAddItem:t,formContextMyDishesSearch:a}=he(),{showToastMsg:n}=R(),r=C(),{isPendingIds:l,restInfo:i,isSuccessIds:c}=_t(),{fields:o}=Ls({control:t.control,name:"items"});m.useEffect(()=>{t!=null&&t.setFocus&&setTimeout(()=>{t.setFocus(`items.${o.length-1}`)},500)},[t,o.length]);const{mutate:d,isPending:u}=E({mutationFn:({form:p,restId:f})=>bi({form:p,restId:f}),onSuccess:p=>{n(`Dish${o.length>1?"es":""} created successfully`,"SUCCESS");const{setValue:f}=a;f("searchVals",["restaurantId"]),f("search",p.restId),f("createdAtSort",["desc"]),r("/my-dishes"),t.reset({restaurant:"",items:[{name:"",price:"",quantity:"",images:[]}]})},onError:p=>s({err:p})}),g=t.handleSubmit(p=>{const f=yn(p);d({form:f,restId:p.restaurant})});return{isPendingIds:l,formContext:t,restInfo:i,isSuccessIds:c,handleSave:g,isPending:u}},Ri=({formContext:s,restInfo:t})=>{var d;const[a,n]=m.useState(!1),{register:r,watch:l,formState:{errors:i},setValue:c}=s,o=u=>l("restaurant")===u;return e.jsxs("div",{className:"w-full grid grid-cols-1 relative my_restaurant_drop__i",children:[e.jsx("div",{className:"h-[60px] sm:h-[50px]"}),((d=i==null?void 0:i.restaurant)==null?void 0:d.message)&&e.jsx("span",{className:"txt__01 -mt-5 sm:mt-0 justify-self-end self-center text-red-600 pt-5",children:i.restaurant.message}),e.jsx("input",{type:"text",...r("restaurant",{required:{value:!0,message:"We need to know to which restaurant you want to add dish 🧐"}}),className:"opacity-0 pointer-events-none"}),e.jsxs("div",{className:"border-2 border-orange-500 rounded-xl w-fit justify-self-end py-1 sm:py-2 px-1 sm:px-3 absolute z-10 bg-[#111]",children:[e.jsx("div",{className:"w-full ",children:e.jsx(q,{isOpen:a,setIsOpen:n,txt:"Restaurant",Icon:Ye})}),e.jsx("ul",{className:`w-full grid grid-cols-1 el__flow pl-1 gap-2 sm:gap-4 overflow-x-scroll hide_scrollbar ${a?"opacity-100 pointer-events-auto max-h-[250px] pb-4":"opacity-0 pointer-events-none max-h-0"}`,children:t==null?void 0:t.map(u=>e.jsx("li",{onClick:()=>c("restaurant",o(u._id)?"":u._id,{shouldValidate:!0}),className:`grid w-full grid-cols-1 border-2 first:mt-3 rounded-xl py-1 sm:py-2 px-2 sm:px-3 cursor-pointer el__flow ${o(u._id)?"border-orange-500 text-orange-500":"border-[#333]"}`,children:e.jsx("span",{className:"txt__01 break-all",children:u.name})},u._id))})]})]})},Ii=({formContext:s,indexForm:t})=>{var c,o,d,u;const{register:a,watch:n,setValue:r,formState:{errors:l}}=s,i=n(`items.${t}.images`);return e.jsxs("div",{className:"w-full flex flex-col gap-2",children:[e.jsxs("span",{className:"txt__03 el__sub_title_my_restaurants_form",children:[e.jsx(Ts,{className:"h-[35px] w-[35px]"}),"Dish images"]}),e.jsx("div",{className:`w-full flex flex-row overflow-x-auto border-[3px] snap-x snap-mandatory gap-5 sm:gap-10 hide_scrollbar rounded-xl el__flow ${(c=n(`items.${t}.images`))!=null&&c.length?"max-h-[500px] p-3 sm:p-6 border-orange-500 mb-2":"max-h-0 border-transparent p-0"}`,children:!!(i!=null&&i.length)&&[...i].map((g,p)=>e.jsx(st,{img:i[p],images:i,setValue:r,indexForm:t},p))}),e.jsx(tt,{register:a,watch:n,indexForm:t}),((d=(o=l==null?void 0:l.items)==null?void 0:o[t])==null?void 0:d.images)&&e.jsx("span",{className:"txt__01 text-red-600",children:(u=l==null?void 0:l.items)==null?void 0:u[t].images.message})]})},Ue={id:h(),label:"Name",field:"name",place:"Dish name...",required:!0,reg:gn,msg:"Dish name must be between 2 and 50 characters"},vt=[{field:"price",reg:de,msg:"Price must be a positive number with up to 2 decimal places"},{field:"quantity",reg:Bs,msg:"Quantity must be a prime number without decimals"}].map(s=>({...s,id:h(),label:s.field[0].toUpperCase()+s.field.slice(1),place:`Dish ${s.field}...`,required:!0,type:"number"})),Ai=[{field:Ue.field,reg:Ue.reg},...vt.map(s=>({field:s.field,reg:s.reg}))],Di=({formContext:s,indexForm:t})=>{const{register:a,formState:{errors:n}}=s;return e.jsxs("div",{className:"w-full grid gap-3",children:[e.jsxs("span",{className:"txt__03 el__sub_title_my_restaurants_form",children:[e.jsx(Fs,{className:"h-[35px] w-[35px]"}),"Dish name"]}),e.jsx("div",{className:"w-full grid grid-cols-1 sm:grid-cols-2",children:e.jsx(X,{field:{...Ue,field:`items.${t}.name`},register:a,errors:n,indexForm:t})})]})},Fi=({formContext:s,indexForm:t})=>{const{register:a,formState:{errors:n}}=s,r=l=>+l<.01?"Price must up greater than $0.01":!0;return e.jsxs("div",{className:"w-full grid grid-cols-1 gap-5",children:[e.jsxs("div",{className:"txt__03 flex flex-wrap items-center gap-5 text-orange-500",children:[e.jsxs("span",{className:"txt__03 flex items-center gap-5 text-orange-500",children:[e.jsx(ha,{className:"h-[35px] w-[35px]"}),"Dish price and"]}),e.jsxs("span",{className:"txt__03 flex items-center gap-5 text-orange-500",children:[e.jsx(V,{className:"h-[35px] w-[35px]"}),"Dish quantity"]})]}),e.jsx("div",{className:"w-full grid grid-cols-1 sm:grid-cols-2 gap-y-3 gap-x-5",children:vt.map(l=>e.jsx(X,{field:{...l,field:`items.${t}.${l.field}`},register:a,errors:n,indexForm:t,customValidate:l.field==="price"?r:void 0},l.id))})]})},Ti=({formContext:s,indexForm:t,removeForm:a})=>e.jsxs("div",{className:"w-full grid grid-cols-1 border-2 rounded-xl border-orange-500 p-5 py-8 gap-5 relative",children:[t!==0&&e.jsx("div",{className:"justify-self-end sm:absolute top-5 right-5",children:e.jsx(ie,{txt:"Remove",handleDelete:()=>a(t)})}),e.jsx(Di,{formContext:s,indexForm:t}),e.jsx(Ii,{formContext:s,indexForm:t}),e.jsx(Fi,{formContext:s,indexForm:t})]}),Nt=({formContext:s,handleSave:t,isPending:a,restInfo:n})=>{const[r,l]=m.useState(!0),i=D(),{control:c,watch:o}=s,{fields:d,append:u,remove:g}=Ls({control:c,name:"items"});m.useEffect(()=>{const y=o(x=>{var _,S;const w=(_=x.items)==null?void 0:_[d.length-1];let j=!((S=w==null?void 0:w.images)!=null&&S.length);for(const T of Ai){const A=w==null?void 0:w[T.field];if(!T.reg.test(A)){j=!0;break}}l(j)});return()=>y.unsubscribe()},[d,o]);const p=()=>{u({name:"",price:"",quantity:"",images:[]}),l(!0)},f=y=>{d.length>1&&(g(y),l(!1))};return e.jsxs("div",{className:"w-full grid grid-cols-1 gap-5",children:[e.jsx(Ri,{restInfo:n,formContext:s}),d.map((y,x)=>e.jsx(Ti,{formContext:s,restInfo:n,indexForm:x,removeForm:f},x)),e.jsx("div",{className:"w-full max-w-[250px] justify-self-center justify-center flex mt-5",children:e.jsx(G,{label:i.pathname==="/my-dishes/add-dish"?"Create":"Update",type:"submit",handleClick:t,isPending:a})}),/^\/(my-dishes)\/(add-dish)/.test(i.pathname)&&(d==null?void 0:d.length)<20&&e.jsx("div",{className:"w-full max-w-[150px] justify-self-start",children:e.jsx(te,{type:"button",label:"Add",styleTxt:"txt__02",handleClick:p,isDisabled:a||r})})]})},ki=()=>{const{isPendingIds:s,formContext:t,restInfo:a,isSuccessIds:n,handleSave:r,isPending:l}=Ci();return s?e.jsx(Y,{}):e.jsxs("div",{className:"w-full grid grid-cols-1 gap-5 justify-items-center",children:[e.jsx("span",{className:"txt__04",children:"Add Dish"}),n&&(a!=null&&a.length)?e.jsx(ue,{...t,children:e.jsx(Nt,{formContext:t,restInfo:a,handleSave:r,isPending:l})}):e.jsx(cs,{txt:"We did not any restaurant 🧐"})]})},fs=({cbMutation:s,setSelected:t})=>{const a=Ne(),{popup:n,setPopup:r}=pe(),{showToastMsg:l}=R(),{handleErrAPI:i}=I(),{mutate:c,isPending:o}=E({mutationFn:d=>(r({...n,isPending:!0}),s(d)),onSuccess:()=>{l("Dishes Deleted successfully","SUCCESS"),t([]),a.resetQueries({queryKey:["myDishesSearch"]})},onError:d=>i({err:d}),onSettled:()=>r(null)});return{mutate:c,isPending:o}},Li=()=>{const[s,t]=m.useState(1),[a,n]=m.useState(6),[r,l]=m.useState([]),i=Ne();F(),nt(a,n);const{formContextMyDishesSearch:c}=he(),{handleErrAPI:o}=I(),{setPopup:d}=pe(),{reset:u,handleSubmit:g,watch:p,trigger:f}=c,y=g(B=>{B.page=s+"",sessionStorage.setItem("myDishesForm",JSON.stringify(B)),i.resetQueries({queryKey:["myDishesSearch"]})}),x=()=>{sessionStorage.removeItem("myDishesForm"),u(kl),f()},w=p();w.page=s+"",w.limit=a+"";const{data:j,isPending:_,isSuccess:S,isError:T,error:A}=ae({queryKey:["myDishesSearch",w],queryFn:()=>_i(ms(w))});m.useEffect(()=>{T&&o({err:A})},[S,T,j,o,A]);const v=B=>l(xe=>xe.includes(B)?xe.filter(Et=>Et!==B):[...xe,B]),Q=()=>l([]),{mutate:P,isPending:K}=fs({cbMutation:Pi,setSelected:l}),J=()=>P(r),k=()=>d({txt:`delete ${r.length} dish${r.length>1?"es":""} ?`,greenLabel:"I changes idea",redLabel:"Delete dishes",confirmAction:J,isPending:K}),{mutate:z,isPending:oe}=fs({cbMutation:Ei,setSelected:l}),L=()=>z(ms(w)),ne=()=>{var B;(B=j==null?void 0:j.dishes)!=null&&B.length&&l(j.dishes.map(xe=>xe._id)),d({txt:"delete all dishes that match query ?",redLabel:"Delete dishes",confirmAction:L,isPending:oe})};return{formContextMyDishesSearch:c,propsForm:{handleSave:y,handleClear:x,isPending:_},propsBlockPages:{currPage:s,setCurrPage:t,totPages:j==null?void 0:j.totPages},data:j,toggleSelected:v,selected:r,handleOpenPopup:k,clearSelected:Q,handleOpenPopupBulkQuery:ne}},Mi=s=>({id:h(),label:"Categories",icon:ya,vals:s}),Ui=(...s)=>[{label:"Price",val:Xe({price:s[0]}),icon:wa},{label:"Quantity",val:s[1],icon:V}].map(t=>({...t,id:h()})),$i=({dish:s,toggleSelected:t,selected:a})=>{const[n,r]=m.useState(!1);return e.jsxs("div",{className:`border-[3px] border-orange-500 rounded-xl py-1 pb-3 max-w-[300px] sm:max-w-[350px] justify-self-center ${a.includes(s._id)?"border-red-600 opacity-50 scale-105":"border-orange-500"}`,children:[e.jsxs("div",{className:"w-full flex flex-col",children:[e.jsx(lt,{id:s._id}),e.jsx(it,{images:s.images,children:e.jsx(ot,{name:s.name})}),e.jsxs("div",{className:"w-full grid grid-cols-1",children:[e.jsx(q,{isOpen:n,setIsOpen:r,txt:"Restaurant",Icon:He,customStyle:"px-3 border-b-2 border-orange-500 py-1"}),e.jsxs("ul",{className:`w-full el__flow grid grid-cols-1 gap-3 px-3 ${n?"opacity-100 max-h-[500px] pointer-events-auto pt-3":"opacity-0 max-h-0 pointer-events-none"}`,children:[e.jsxs("li",{className:"w-full grid grid-cols-[80px_1fr]",children:[e.jsxs("div",{className:"w-full flex gap-5 justify-start items-center",children:[e.jsx(ja,{className:"min-w-[30px] min-h-[30px]"}),e.jsx("span",{className:"txt__01",children:"Name"})]}),e.jsx("span",{className:"txt__01 justify-self-end",children:s.name})]}),e.jsxs("li",{className:"w-full grid grid-cols-[80px_1fr]",children:[e.jsxs("div",{className:"w-full flex gap-5 justify-start items-center",children:[e.jsx(V,{className:"min-w-[30px] min-h-[30px]"}),e.jsx("span",{className:"txt__01",children:"Id"})]}),e.jsx("div",{className:"flex w-full justify-end",children:e.jsx(rt,{txt:s.restaurant,label:"Id"})})]}),e.jsx("div",{className:"-mx-3",children:e.jsx(ct,{el:Mi(s.categories)})})]}),e.jsx("ul",{className:"w-full grid grid-cols-1 gap-2 px-3",children:Ui(s.price,s.quantity).map((l,i)=>e.jsxs("li",{className:"w-full grid grid-cols-[80px_1fr] first:pt-2",children:[e.jsxs("div",{className:"w-full flex gap-5 items-center",children:[e.jsx(l.icon,{className:"min-w-[30px] min-h-[30px]"}),e.jsx("span",{className:"txt__01",children:l.label})]}),e.jsx("span",{className:"txt__01 justify-self-end",children:l.val})]},i))})]})]}),e.jsxs("div",{className:"w-full grid grid-cols-2 mt-5 items-center",children:[e.jsxs(re,{to:`/my-dishes/update/${s._id}`,className:"el__flow el__after_below txt__02 justify-self-center w-fit flex gap-3 group cursor-pointer",children:[e.jsx(ba,{className:"min-w-[30px] min-h-[30px] el__flow group-hover:text-orange-500"}),e.jsx("span",{className:"el__flow txt__02 group-hover:text-orange-500",children:"Update"})]}),e.jsx("div",{className:"w-full flex justify-center",children:e.jsx(ie,{txt:"Delete",border:!1,handleDelete:()=>t(s._id)})})]})]})},Vi=()=>{const{formContextMyDishesSearch:s,propsForm:t,propsBlockPages:a,data:n,toggleSelected:r,selected:l,handleOpenPopup:i,clearSelected:c,handleOpenPopupBulkQuery:o}=Li(),{totDocuments:d,nHits:u,dishes:g}=n??{};return e.jsxs("div",{className:"w-full grid grid-cols-1 justify-items-center gap-5",children:[e.jsx("span",{className:"txt__04",children:"My Dishes"}),e.jsx(ue,{...s,children:e.jsx(gt,{...t,formContext:s,searchFields:Dl,filters:pt,sorters:xt})}),e.jsx(ht,{nHits:u,totDocuments:d,isPending:t.isPending}),!!(l!=null&&l.length)&&e.jsxs("div",{className:"w-full grid grid-cols-1 sm:grid-cols-2 mt-3 px-3 gap-4 justify-items-start sm:justify-items-center",children:[e.jsx("div",{className:"w-full flex gap-5 border-2 border-red-600 rounded-xl py-2 px-4 pr-6 max-w-fit items-center",children:e.jsxs("span",{className:"txt__02",children:["Items selected: ",l.length]})}),e.jsx("button",{onClick:c,className:"w-full flex gap-5 border-2 border-green-600 rounded-xl py-2 px-4 pr-6 max-w-fit el__flow hover:text-green-600 hover:scale-110 cursor-pointer items-center",children:e.jsx("span",{className:"txt__02",children:"Cancel operation"})}),e.jsx(ie,{txt:"Delete selected",handleDelete:i}),e.jsx(ie,{txt:"Delete results searched",handleDelete:o})]}),t.isPending?e.jsx(Y,{}):g&&e.jsx("div",{className:"w-full grid grid-cols-1 sm:grid-cols-[repeat(auto-fit,minmax(350px,1fr))] justify-items-center gap-10 mt-5 items-start",children:g.map(p=>e.jsx($i,{dish:p,toggleSelected:r,selected:l},p._id))}),e.jsx(ft,{...a})]})},Oi=()=>{const{formContextMyDishesUpdate:s,formContextMyDishesSearch:t}=he(),{handleErrAPI:a}=I(),{showToastMsg:n}=R(),{setPopup:r,popup:l}=pe();F();const{setValue:i,reset:c}=s,o=Se(),d=C(),u=o==null?void 0:o.dishId,g=W.test(u??""),{isPendingIds:p,restInfo:f,isSuccessIds:y}=_t(),{data:x,isPending:w,isSuccess:j,isError:_,error:S}=ae({queryKey:["myDishInfo",u],queryFn:()=>vi(u??""),enabled:g});m.useEffect(()=>{(()=>{if(_)a({err:S});else if(j&&Object.keys(x??{}).length){const{dish:{name:z="",price:oe=0,quantity:L=0,images:ne=[],restaurant:B=""}={}}=x??{};c({restaurant:B,items:[{name:z,price:oe+"",quantity:L+"",images:ne}]})}})()},[a,j,_,S,x,u,i,c]);const{mutate:T,isPending:A}=E({mutationFn:({formData:k,id:z})=>Si({formData:k,id:z}),onSuccess:k=>{n("Dish updated successfully","SUCCESS");const{setValue:z}=t;z("searchVals",["id"]),z("search",k.dishId),z("updatedAtSort",["desc"]),d("/my-dishes",{replace:!0}),c()},onError:k=>{a({err:k})}}),v=s.handleSubmit(k=>{const z=wn(k);T({formData:z,id:u??""})}),{mutate:Q,isPending:P}=E({mutationFn:()=>(r({...l,isPending:!0}),Ni(u??"")),onSuccess:()=>{n("Dish deleted successfully","SUCCESS"),c(),d("/my-dishes",{replace:!0})},onError:k=>{a({err:k})},onSettled:()=>r(null)}),K=()=>{Q()};return{formContext:s,handleSave:v,isPendingPage:p||w,restInfo:f,isSuccessIds:y,canStay:g,handleOpenPopup:()=>{r({txt:"delete this dish ?",greenLabel:"I change idea",redLabel:"Delete dish",isPending:P,confirmAction:K})},isPending:A}},Bi=()=>{const{formContext:s,handleSave:t,isPendingPage:a,restInfo:n,isSuccessIds:r,canStay:l,handleOpenPopup:i,isPending:c}=Oi();return e.jsxs("div",{className:"w-full grid grid-cols-1 gap-5 justify-items-center",children:[e.jsx("span",{className:"txt__04",children:"Update Dish"}),e.jsx("div",{className:"justify-self-start",children:e.jsx(ie,{txt:"Delete Dish",handleDelete:i})}),l?a?e.jsx(Y,{}):r&&(n!=null&&n.length)?e.jsx(ue,{...s,children:e.jsx(Nt,{formContext:s,handleSave:t,restInfo:n,isPending:c})}):e.jsx(cs,{txt:"We did not any restaurant 🧐"}):e.jsx(U,{to:"/",replace:!0})]})},qi=()=>e.jsx(Y,{}),zi=()=>(Gl(),e.jsxs(_a,{children:[e.jsxs(N,{path:"/",element:e.jsx(ui,{}),children:[e.jsx(N,{index:!0,element:e.jsx(Ra,{})}),e.jsxs(N,{path:"auth",element:e.jsx(mi,{}),children:[e.jsx(N,{path:"login",element:e.jsx(wr,{})}),e.jsx(N,{path:"register",element:e.jsx(vr,{})}),e.jsx(N,{path:"send-email",element:e.jsx(Pr,{})}),e.jsx(N,{path:"verify",element:e.jsx(Ir,{})}),e.jsx(N,{path:"recover-pwd",element:e.jsx(Dr,{})})]}),e.jsxs(N,{path:"user",element:e.jsx(pi,{}),children:[e.jsx(N,{path:"profile",element:e.jsx(Hr,{})}),e.jsx(N,{path:"manage-account",element:e.jsx(cl,{})})]}),e.jsx(N,{path:"verify-new-email",element:e.jsx(ul,{})}),e.jsx(N,{path:"notice-email",element:e.jsx(Aa,{})}),e.jsxs(N,{path:"newsletter",element:e.jsx(xi,{}),children:[e.jsx(N,{path:"verify-unsubscribe",element:e.jsx(Zr,{})}),e.jsx(N,{path:"notice-unsubscribe-with-retry",element:e.jsx(Kr,{})})]}),e.jsxs(N,{path:"my-restaurants",element:e.jsx(gi,{}),children:[e.jsx(N,{index:!0,element:e.jsx(Bl,{})}),e.jsx(N,{path:":restId",element:e.jsx(yi,{})}),e.jsx(N,{path:"add-restaurant",element:e.jsx(Sl,{})}),e.jsx(N,{path:"update/:restId",element:e.jsx(zl,{})})]}),e.jsxs(N,{path:"my-dishes",element:e.jsx(wi,{}),children:[e.jsx(N,{index:!0,element:e.jsx(Vi,{})}),e.jsx(N,{path:"add-dish",element:e.jsx(ki,{})}),e.jsx(N,{path:"update/:dishId",element:e.jsx(Bi,{})})]}),e.jsx(N,{path:"test-loader",element:e.jsx(qi,{})})]}),e.jsx(N,{path:"*",element:e.jsx(U,{to:"/",replace:!0})})]})),St="SET_IS_POPUP",Pt={popup:null},Gi=(s,t)=>{switch(t.type){case St:{const a=t.payload;return a?{popup:a}:Pt}default:return s}},$e="SET_IS_TOAST",Qi=(s,t)=>{const{isToast:a,msg:n,type:r}=t.payload;if(!a)return{...s,isToast:a};if(a&&[n,r].some(l=>!l))throw new Error("Missing fields "+t.type);return{...s,isToast:a,msg:n??"",type:r??"SUCCESS"}},Hi=(s,t)=>{switch(t.type){case $e:return Qi(s,t);default:return s}},Ve="SET_IS_LOGGED",Oe="SET_CURR_USER",Be="SET_CAN_MANAGE_ACCOUNT",Yi=(s,t)=>{switch(t.type){case Ve:return{...s,isLogged:t.payload};case Oe:return{...s,currUser:t.payload};case Be:return{...s,canManageAccount:t.payload};default:return s}},Zi=(s,t)=>({toastState:Hi(s.toastState,t),userState:Yi(s.userState,t),popupState:Gi(s.popupState,t)}),Wi={isToast:!1,msg:"",type:"SUCCESS"},Ki={currUser:null,isLogged:!!sessionStorage.getItem("accessToken"),canManageAccount:!!sessionStorage.getItem("manageAccountToken")},Xi={toastState:Wi,userState:Ki,popupState:Pt},Ji=(s,t)=>{const a=()=>t({type:$e,payload:{isToast:!1}}),n=m.useCallback((r,l)=>{setTimeout(()=>{t({type:$e,payload:{isToast:!0,msg:r,type:l}})},0)},[t]);return{closeToast:a,showToastMsg:n,...s}},eo=(s,t)=>{const a=m.useCallback(i=>{i?sessionStorage.setItem("accessToken",i):sessionStorage.removeItem("accessToken"),t({type:Ve,payload:!!i})},[t]),n=m.useCallback(({user:i})=>{i?sessionStorage.getItem("initName")||sessionStorage.setItem("initName",hn(i)):sessionStorage.removeItem("initName"),t({type:Oe,payload:i})},[t]),r=m.useCallback(i=>{i?sessionStorage.setItem("manageAccountToken",i):sessionStorage.removeItem("manageAccountToken"),t({type:Be,payload:!!i})},[t]),l=m.useCallback(()=>{sessionStorage.removeItem("accessToken"),sessionStorage.removeItem("manageAccountToken"),sessionStorage.removeItem("initName"),t({type:Ve,payload:!1}),t({type:Oe,payload:null}),t({type:Be,payload:!1})},[t]);return{...s,setCurrUser:n,setUserLogged:a,setCanManageAccount:r,logoutUser:l}},so=(s,t)=>({setPopup:m.useCallback(n=>t({type:St,payload:n}),[t]),...s}),to=()=>{const s=sessionStorage.getItem("myRestaurantsForm"),t=M({mode:"onChange",defaultValues:s?{...JSON.parse(s)}:{searchVals:["name"]}}),a=M({mode:"onChange",defaultValues:{restaurant:"",items:[{name:"",quantity:"",price:"",images:[]}]}}),n=M({mode:"onChange"}),r=sessionStorage.getItem("myDishesForm"),l=M({mode:"onChange",defaultValues:r?{...JSON.parse(r)}:{searchVals:["name"]}});return{formContextMyRestaurants:t,formContextMyDishesAddItem:a,formContextMyDishesSearch:l,formContextMyDishesUpdate:n}},ao=()=>{const[s,t]=m.useReducer(Zi,Xi),a=Ji(s.toastState,t),n=eo(s.userState,t),r=so(s.popupState,t),l=to();return{toastState:{...a},userState:{...n},popupState:{...r},formsState:{...l}}},no=({children:s})=>e.jsx(Ms.Provider,{value:{...ao()},children:s}),ro=new Ca({defaultOptions:{queries:{retry:!1,refetchOnWindowFocus:!1},mutations:{retry:!1}}});va.createRoot(document.getElementById("root")).render(e.jsx(m.StrictMode,{children:e.jsx(Na,{children:e.jsx(Sa,{client:ro,children:e.jsx(no,{children:e.jsx(zi,{})})})})}));
